(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_react-map-ol"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_react-map-ol"]||[]).push([["c5ce9272"],{c5ce9272:function(e,t,i){i.d(t,"__esModule",{value:!0}),i.e(t,{default:function(){return rl;}});var r=i("777fffbe"),n=i("852bbaa9"),s=i("766571df"),o=i("e6ebd2e4"),a=n._(o),l=i("0cdd686b"),h=i("c4066a9d"),d=i("6a556f0a");let u={Foo:{type:"COMPONENT",id:"Foo",title:"Foo",propsConfig:{type:"object",required:["title"],className:"__type",properties:{title:{type:"string"}}}},Map:{type:"COMPONENT",id:"Map",title:"Map",propsConfig:{type:"object",required:["mapId","center","zoom"],className:"MapProps",properties:{mapId:{type:"string",description:"\u5730\u56FEid"},center:{type:"array",minItems:2,maxItems:2,description:"\u4E2D\u5FC3\u70B9\u5750\u6807",items:[{type:"number"},{type:"number"}]},zoom:{type:"number",description:"\u7F29\u653E\u7EA7\u522B"},defaultOptions:{type:"object",description:"\u5730\u56FE\u521D\u59CB\u5316\u65F6\u7684\u9ED8\u8BA4\u914D\u7F6E"},minZoom:{type:"number",description:"\u4E2A\u6027\u5316\u5730\u56FE\u6837\u5F0F; \u5730\u56FE\u6700\u5C0F\u7F29\u653E\u7EA7\u522B"},maxZoom:{type:"number",description:"\u5730\u56FE\u6700\u5927\u7F29\u653E\u7EA7\u522B"},backgroundColor:{type:"array",className:"Array",description:"\u5730\u56FE\u7C7B\u578B\uFF0C\u666E\u901A\u5730\u56FE\u6216\u5730\u7403\u6A21\u5F0F; \u5730\u56FE\u80CC\u666F\u989C\u8272\uFF0C\u4F20rgba\u683C\u5F0F\u957F\u5EA6\u4E3A4\u7684\u6570\u7EC4",items:{type:"number"}},displayOptions:{type:"object",description:"\u5730\u56FE\u663E\u793A\u914D\u7F6E"},heading:{type:"number",description:"\u5730\u56FE\u65CB\u8F6C\u89D2\u5EA6"},tilt:{type:"number",description:"\u5730\u56FE\u503E\u659C\u89D2\u5EA6"},enableScrollWheelZoom:{type:"boolean",description:"\u662F\u5426\u5F00\u542F\u9F20\u6807\u6EDA\u8F6E\u7F29\u653E"},enableDoubleClickZoom:{type:"boolean",description:"\u662F\u5426\u5F00\u542F\u53CC\u51FB\u9F20\u6807\u7F29\u653E"},enableRotate:{type:"boolean",description:"\u662F\u5426\u5F00\u542F\u5730\u56FE\u65CB\u8F6C\u529F\u80FD"},enableTilt:{type:"boolean",description:"\u662F\u5426\u5F00\u542F\u5730\u56FE\u503E\u659C\u529F\u80FD"},enableDragging:{type:"boolean",description:"\u662F\u5426\u5F00\u542F\u5730\u56FE\u53EF\u62D6\u62FD\u7F29\u653E"},onClick:{type:"function",signature:{isAsync:!1,returnType:{type:"void"},arguments:[{key:"e",type:"Event",isRequired:!0}]},description:"\u9F20\u6807\u5DE6\u952E\u5355\u51FB\u4E8B\u4EF6\u7684\u56DE\u8C03\u51FD\u6570",className:"onClick"},className:{type:"string",description:"\u5730\u56FE\u5BB9\u5668\u7684class\u7C7B\u540D"},style:{type:"object",className:"CSSProperties",description:"\u5730\u56FE\u5BB9\u5668\u7236\u5143\u7D20\u7684style\u6837\u5F0F"},children:{type:"reactNode",className:"ReactNode"}}}}};var c=i("cee59b1c");let g=e=>(0,s.jsxs)("h4",{children:[e.title,"\u6D4B\u8BD5"]});var p={ADD:"add",REMOVE:"remove"},_=i("c672d404"),f=r._(_),m=i("fc92f61f"),y=r._(m);let v="length";class E extends y.default{constructor(e,t,i){super(e),this.element=t,this.index=i;}}class x extends f.default{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e||[],this.unique_)for(let e=0,t=this.array_.length;e<t;++e)this.assertUnique_(this.array_[e],e);this.updateLength_();}clear(){for(;this.getLength()>0;)this.pop();}extend(e){for(let t=0,i=e.length;t<i;++t)this.push(e[t]);return this;}forEach(e){let t=this.array_;for(let i=0,r=t.length;i<r;++i)e(t[i],i,t);}getArray(){return this.array_;}item(e){return this.array_[e];}getLength(){return this.get(v);}insertAt(e,t){if(e<0||e>this.getLength())throw Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new E(p.ADD,t,e));}pop(){return this.removeAt(this.getLength()-1);}push(e){this.unique_&&this.assertUnique_(e);let t=this.getLength();return this.insertAt(t,e),this.getLength();}remove(e){let t=this.array_;for(let i=0,r=t.length;i<r;++i)if(t[i]===e)return this.removeAt(i);}removeAt(e){if(e<0||e>=this.getLength())return;let t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new E(p.REMOVE,t,e)),t;}setAt(e,t){if(e>=this.getLength()){this.insertAt(e,t);return;}if(e<0)throw Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);let i=this.array_[e];this.array_[e]=t,this.dispatchEvent(new E(p.REMOVE,i,e)),this.dispatchEvent(new E(p.ADD,t,e));}updateLength_(){this.set(v,this.array_.length);}assertUnique_(e,t){for(let i=0,r=this.array_.length;i<r;++i)if(this.array_[i]===e&&i!==t)throw Error("Duplicate item added to a unique collection");}}class w extends y.default{constructor(e,t,i){super(e),this.map=t,this.frameState=void 0!==i?i:null;}}class b extends w{constructor(e,t,i,r,n,s){super(e,t,n),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=void 0!==r&&r,this.activePointers=s;}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_;}set pixel(e){this.pixel_=e;}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_;}set coordinate(e){this.coordinate_=e;}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault();}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation();}}var C=i("1780b2e1"),T=r._(C),L=i("385bf8c4"),S=r._(L),A=i("c287f9c3"),R=r._(A),I=i("58cfbd9d"),D=i("64cc509c"),O={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class P extends R.default{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=void 0===t?1:t,this.down_=null;let i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=(0,I.listen)(i,O.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=(0,I.listen)(i,O.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(S.default.TOUCHMOVE,this.boundHandleTouchMove_,!!D.PASSIVE_EVENT_LISTENERS&&{passive:!1});}emulateClick_(e){let t=new b(T.default.CLICK,this.map_,e);this.dispatchEvent(t),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new b(T.default.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;let t=new b(T.default.SINGLECLICK,this.map_,e);this.dispatchEvent(t);},250);}updateActivePointers_(e){let t=e.pointerId;if(e.type==T.default.POINTERUP||e.type==T.default.POINTERCANCEL){for(let i in delete this.trackedTouches_[t],this.trackedTouches_)if(this.trackedTouches_[i].target!==e.target){delete this.trackedTouches_[i];break;}}else(e.type==T.default.POINTERDOWN||e.type==T.default.POINTERMOVE)&&(this.trackedTouches_[t]=e);this.activePointers_=Object.values(this.trackedTouches_);}handlePointerUp_(e){this.updateActivePointers_(e);let t=new b(T.default.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),0===this.activePointers_.length&&(this.dragListenerKeys_.forEach(I.unlistenByKey),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null);}isMouseActionButton_(e){return 0===e.button;}handlePointerDown_(e){this.emulateClicks_=0===this.activePointers_.length,this.updateActivePointers_(e);let t=new b(T.default.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),0===this.dragListenerKeys_.length){let e=this.map_.getOwnerDocument();this.dragListenerKeys_.push((0,I.listen)(e,T.default.POINTERMOVE,this.handlePointerMove_,this),(0,I.listen)(e,T.default.POINTERUP,this.handlePointerUp_,this),(0,I.listen)(this.element_,T.default.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==e&&this.dragListenerKeys_.push((0,I.listen)(this.element_.getRootNode(),T.default.POINTERUP,this.handlePointerUp_,this));}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;let t=new b(T.default.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t);}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;let t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new b(T.default.POINTERMOVE,this.map_,e,t));}handleTouchMove_(e){let t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&("boolean"!=typeof e.cancelable||!0===e.cancelable)&&e.preventDefault();}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_;}disposeInternal(){this.relayedListenerKey_&&((0,I.unlistenByKey)(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(S.default.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&((0,I.unlistenByKey)(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(I.unlistenByKey),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal();}}var M=i("7993751b"),k=r._(M),F={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},N=i("3cfe7f8b"),z=r._(N),K=i("cb38851a"),B=r._(K),G=i("821715d8"),U=i("a05d6eb8");let V=1/0;class j{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={};}clear(){this.elements_.length=0,this.priorities_.length=0,(0,U.clear)(this.queuedElements_);}dequeue(){let e=this.elements_,t=this.priorities_,i=e[0];1==e.length?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));let r=this.keyFunction_(i);return delete this.queuedElements_[r],i;}enqueue(e){(0,G.assert)(!(this.keyFunction_(e) in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");let t=this.priorityFunction_(e);return t!=V&&(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0);}getCount(){return this.elements_.length;}getLeftChildIndex_(e){return 2*e+1;}getRightChildIndex_(e){return 2*e+2;}getParentIndex_(e){return e-1>>1;}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e);}isEmpty(){return 0===this.elements_.length;}isKeyQueued(e){return e in this.queuedElements_;}isQueued(e){return this.isKeyQueued(this.keyFunction_(e));}siftUp_(e){let t=this.elements_,i=this.priorities_,r=t.length,n=t[e],s=i[e],o=e;for(;e<r>>1;){let n=this.getLeftChildIndex_(e),s=this.getRightChildIndex_(e),o=s<r&&i[s]<i[n]?s:n;t[e]=t[o],i[e]=i[o],e=o;}t[e]=n,i[e]=s,this.siftDown_(o,e);}siftDown_(e,t){let i=this.elements_,r=this.priorities_,n=i[t],s=r[t];for(;t>e;){let e=this.getParentIndex_(t);if(r[e]>s)i[t]=i[e],r[t]=r[e],t=e;else break;}i[t]=n,r[t]=s;}reprioritize(){let e,t,i;let r=this.priorityFunction_,n=this.elements_,s=this.priorities_,o=0,a=n.length;for(t=0;t<a;++t)(i=r(e=n[t]))==V?delete this.queuedElements_[this.keyFunction_(e)]:(s[o]=i,n[o++]=e);n.length=o,s.length=o,this.heapify_();}}class W extends j{constructor(e,t){super(t=>e.apply(null,t),e=>e[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={};}enqueue(e){let t=super.enqueue(e);return t&&e[0].addEventListener(S.default.CHANGE,this.boundHandleTileChange_),t;}getTilesLoading(){return this.tilesLoading_;}handleTileChange(e){let t=e.target,i=t.getState();if(i===B.default.LOADED||i===B.default.ERROR||i===B.default.EMPTY){i!==B.default.ERROR&&t.removeEventListener(S.default.CHANGE,this.boundHandleTileChange_);let e=t.getKey();e in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[e],--this.tilesLoading_),this.tileChangeCallback_();}}loadMoreTiles(e,t){let i=0;for(;this.tilesLoading_<e&&i<t&&this.getCount()>0;){let e=this.dequeue()[0],t=e.getKey();e.getState()!==B.default.IDLE||t in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[t]=!0,++this.tilesLoading_,++i,e.load());}}}var X=i("ff2c6715"),H=r._(X),q=i("a99650c5"),Y=r._(q),$=i("cf8d4e7e"),Z=i("c61d4a9a"),J=i("2306c602"),Q=i("c4d58b10"),ee=i("0ac45553"),et=i("a6b10550"),ei=r._(et);class er extends ei.default{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=void 0===e.collapsed||e.collapsed,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=void 0!==e.collapsible,this.collapsible_=void 0===e.collapsible||e.collapsible,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;let t=void 0!==e.className?e.className:"ol-attribution",i=void 0!==e.tipLabel?e.tipLabel:"Attributions",r=void 0!==e.expandClassName?e.expandClassName:t+"-expand",n=void 0!==e.collapseLabel?e.collapseLabel:"\u203A",s=void 0!==e.collapseClassName?e.collapseClassName:t+"-collapse";"string"==typeof n?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=n,this.collapseLabel_.className=s):this.collapseLabel_=n;let o=void 0!==e.label?e.label:"i";"string"==typeof o?(this.label_=document.createElement("span"),this.label_.textContent=o,this.label_.className=r):this.label_=o;let a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(a),this.toggleButton_.addEventListener(S.default.CLICK,this.handleClick_.bind(this),!1);let l=t+" "+J.CLASS_UNSELECTABLE+" "+J.CLASS_CONTROL+(this.collapsed_&&this.collapsible_?" "+J.CLASS_COLLAPSED:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=l,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0;}collectSourceAttributions_(e){let t=this.getMap().getAllLayers(),i=new Set(t.flatMap(t=>t.getAttributions(e)));if(void 0!==this.attributions_&&(Array.isArray(this.attributions_)?this.attributions_.forEach(e=>i.add(e)):i.add(this.attributions_)),!this.overrideCollapsible_){let e=!t.some(e=>{var t;return(null===(t=e.getSource())||void 0===t?void 0:t.getAttributionsCollapsible())===!1;});this.setCollapsible(e);}return Array.from(i);}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return;}let t=await Promise.all(this.collectSourceAttributions_(e).map(e=>(0,ee.toPromise)(()=>e))),i=t.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!(0,$.equals)(t,this.renderedAttributions_)){(0,Q.removeChildren)(this.ulElement_);for(let e=0,i=t.length;e<i;++e){let i=document.createElement("li");i.innerHTML=t[e],this.ulElement_.appendChild(i);}this.renderedAttributions_=t;}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_;}handleToggle_(){this.element.classList.toggle(J.CLASS_COLLAPSED),this.collapsed_?(0,Q.replaceNode)(this.collapseLabel_,this.label_):(0,Q.replaceNode)(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_));}getCollapsible(){return this.collapsible_;}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_());}setCollapsed(e){this.userCollapsed_=e,this.collapsible_&&this.collapsed_!==e&&this.handleToggle_();}getCollapsed(){return this.collapsed_;}render(e){this.updateElement_(e.frameState);}}var en=i("880fc4c6");class es extends ei.default{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});let t=void 0!==e.className?e.className:"ol-rotate",i=void 0!==e.label?e.label:"\u21E7",r=void 0!==e.compassClassName?e.compassClassName:"ol-compass";this.label_=null,"string"==typeof i?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));let n=e.tipLabel?e.tipLabel:"Reset rotation",s=document.createElement("button");s.className=t+"-reset",s.setAttribute("type","button"),s.title=n,s.appendChild(this.label_),s.addEventListener(S.default.CLICK,this.handleClick_.bind(this),!1);let o=t+" "+J.CLASS_UNSELECTABLE+" "+J.CLASS_CONTROL,a=this.element;a.className=o,a.appendChild(s),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=void 0!==e.duration?e.duration:250,this.autoHide_=void 0===e.autoHide||e.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(J.CLASS_HIDDEN);}handleClick_(e){e.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_();}resetNorth_(){let e=this.getMap().getView();if(!e)return;let t=e.getRotation();void 0!==t&&(this.duration_>0&&t%(2*Math.PI)!=0?e.animate({rotation:0,duration:this.duration_,easing:en.easeOut}):e.setRotation(0));}render(e){let t=e.frameState;if(!t)return;let i=t.viewState.rotation;if(i!=this.rotation_){if(this.autoHide_){let e=this.element.classList.contains(J.CLASS_HIDDEN);e||0!==i?e&&0!==i&&this.element.classList.remove(J.CLASS_HIDDEN):this.element.classList.add(J.CLASS_HIDDEN);}this.label_.style.transform="rotate("+i+"rad)";}this.rotation_=i;}}class eo extends ei.default{constructor(e){super({element:document.createElement("div"),target:(e=e||{}).target});let t=void 0!==e.className?e.className:"ol-zoom",i=void 0!==e.delta?e.delta:1,r=void 0!==e.zoomInClassName?e.zoomInClassName:t+"-in",n=void 0!==e.zoomOutClassName?e.zoomOutClassName:t+"-out",s=void 0!==e.zoomInLabel?e.zoomInLabel:"+",o=void 0!==e.zoomOutLabel?e.zoomOutLabel:"\u2013",a=void 0!==e.zoomInTipLabel?e.zoomInTipLabel:"Zoom in",l=void 0!==e.zoomOutTipLabel?e.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=r,h.setAttribute("type","button"),h.title=a,h.appendChild("string"==typeof s?document.createTextNode(s):s),h.addEventListener(S.default.CLICK,this.handleClick_.bind(this,i),!1);let d=document.createElement("button");d.className=n,d.setAttribute("type","button"),d.title=l,d.appendChild("string"==typeof o?document.createTextNode(o):o),d.addEventListener(S.default.CLICK,this.handleClick_.bind(this,-i),!1);let u=t+" "+J.CLASS_UNSELECTABLE+" "+J.CLASS_CONTROL,c=this.element;c.className=u,c.appendChild(h),c.appendChild(d),this.duration_=void 0!==e.duration?e.duration:250;}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e);}zoomByDelta_(e){let t=this.getMap().getView();if(!t)return;let i=t.getZoom();if(void 0!==i){let r=t.getConstrainedZoom(i+e);this.duration_>0?(t.getAnimating()&&t.cancelAnimations(),t.animate({zoom:r,duration:this.duration_,easing:en.easeOut})):t.setZoom(r);}}}function ea(e){e=e||{};let t=new x;return(void 0===e.zoom||e.zoom)&&t.push(new eo(e.zoomOptions)),(void 0===e.rotate||e.rotate)&&t.push(new es(e.rotateOptions)),(void 0===e.attribution||e.attribution)&&t.push(new er(e.attributionOptions)),t;}var el=i("47eafe05");class eh{constructor(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0;}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0;}update(e,t){this.points_.push(e,t,Date.now());}end(){if(this.points_.length<6)return!1;let e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let i=t-3;for(;i>0&&this.points_[i+2]>e;)i-=3;let r=this.points_[t+2]-this.points_[i+2];if(r<1e3/60)return!1;let n=this.points_[t]-this.points_[i],s=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(s,n),this.initialVelocity_=Math.sqrt(n*n+s*s)/r,this.initialVelocity_>this.minVelocity_;}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_;}getAngle(){return this.angle_;}}var ed=i("952d7b8f"),eu=n._(ed);class ec extends eu.default{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=void 0!==e.duration?e.duration:250;}handleEvent(e){let t=!1;if(e.type==T.default.DBLCLICK){let i=e.originalEvent,r=e.map,n=e.coordinate,s=i.shiftKey?-this.delta_:this.delta_,o=r.getView();(0,eu.zoomByDelta)(o,s,n,this.duration_),i.preventDefault(),t=!0;}return!t;}}var eg=i("348b7b1a"),ep=i("7985343e"),e_=i("53b25ab4"),ef=n._(e_);class em extends ef.default{constructor(e){super({stopDown:ee.FALSE}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;let t=e.condition?e.condition:(0,ep.all)(ep.noModifierKeys,ep.primaryAction);this.condition_=e.onFocusOnly?(0,ep.all)(ep.focusWithTabindex,t):t,this.noKinetic_=!1;}handleDragEvent(e){let t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());let i=this.targetPointers,r=t.getEventPixel((0,ef.centroid)(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){let t=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],i=e.map.getView();(0,eg.scale)(t,i.getResolution()),(0,eg.rotate)(t,i.getRotation()),i.adjustCenterInternal(t);}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,e.originalEvent.preventDefault();}handleUpEvent(e){let t=e.map,i=t.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){let e=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),n=i.getCenterInternal(),s=t.getPixelFromCoordinateInternal(n),o=t.getCoordinateFromPixelInternal([s[0]-e*Math.cos(r),s[1]-e*Math.sin(r)]);i.animateInternal({center:i.getConstrainedCenter(o),duration:500,easing:en.easeOut});}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1;}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0;}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){let t=e.map.getView();return this.lastCentroid=null,t.getAnimating()&&t.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0;}return!1;}}var ey=i("7621ed37");class ev extends ef.default{constructor(e){e=e||{},super({stopDown:ee.FALSE}),this.condition_=e.condition?e.condition:ep.altShiftKeysOnly,this.lastAngle_=void 0,this.duration_=void 0!==e.duration?e.duration:250;}handleDragEvent(e){if(!(0,ep.mouseOnly)(e))return;let t=e.map,i=t.getView();if(i.getConstraints().rotation===ey.disable)return;let r=t.getSize(),n=e.pixel,s=Math.atan2(r[1]/2-n[1],n[0]-r[0]/2);if(void 0!==this.lastAngle_){let e=s-this.lastAngle_;i.adjustRotationInternal(-e);}this.lastAngle_=s;}handleUpEvent(e){return!(0,ep.mouseOnly)(e)||(e.map.getView().endInteraction(this.duration_),!1);}handleDownEvent(e){return!!(0,ep.mouseOnly)(e)&&!!((0,ep.mouseActionButton)(e)&&this.condition_(e))&&(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0);}}var eE=i("319a05d0"),ex=r._(eE),ew=i("58b3e7fb"),eb=r._(ew);class eC extends ex.default{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null;}disposeInternal(){this.setMap(null);}render_(){let e=this.startPixel_,t=this.endPixel_,i=this.element_.style;i.left=Math.min(e[0],t[0])+"px",i.top=Math.min(e[1],t[1])+"px",i.width=Math.abs(t[0]-e[0])+"px",i.height=Math.abs(t[1]-e[1])+"px";}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);let e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit";}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_);}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_();}createOrUpdateGeometry(){if(!this.map_)return;let e=this.startPixel_,t=this.endPixel_,i=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new eb.default([i]);}getGeometry(){return this.geometry_;}}let eT={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class eL extends y.default{constructor(e,t,i){super(e),this.coordinate=t,this.mapBrowserEvent=i;}}class eS extends ef.default{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new eC(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??ep.mouseActionButton,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition;}defaultBoxEndCondition(e,t,i){let r=i[0]-t[0],n=i[1]-t[1];return r*r+n*n>=this.minArea_;}getGeometry(){return this.box_.getGeometry();}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new eL(eT.BOXDRAG,e.coordinate,e)));}handleUpEvent(e){if(!this.startPixel_)return!1;let t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new eL(t?eT.BOXEND:eT.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1;}handleDownEvent(e){return!!this.condition_(e)&&(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new eL(eT.BOXSTART,e.coordinate,e)),!0);}onBoxEnd(e){}setActive(e){!e&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new eL(eT.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e);}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new eL(eT.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e);}}class eA extends eS{constructor(e){super({condition:(e=e||{}).condition?e.condition:ep.shiftKeyOnly,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=void 0!==e.duration?e.duration:200,this.out_=void 0!==e.out&&e.out;}onBoxEnd(e){let t=this.getMap().getView(),i=this.getGeometry();if(this.out_){let e=t.rotatedExtentForGeometry(i),r=t.getResolutionForExtentInternal(e),n=t.getResolution()/r;(i=i.clone()).scale(n*n);}t.fitInternal(i,{duration:this.duration_,easing:en.easeOut});}}var eR={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class eI extends eu.default{constructor(e){super(),e=e||{},this.defaultCondition_=function(e){return(0,ep.noModifierKeys)(e)&&(0,ep.targetNotEditable)(e);},this.condition_=void 0!==e.condition?e.condition:this.defaultCondition_,this.duration_=void 0!==e.duration?e.duration:100,this.pixelDelta_=void 0!==e.pixelDelta?e.pixelDelta:128;}handleEvent(e){let t=!1;if(e.type==S.default.KEYDOWN){let i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==eR.DOWN||r==eR.LEFT||r==eR.RIGHT||r==eR.UP)){let n=e.map.getView(),s=n.getResolution()*this.pixelDelta_,o=0,a=0;r==eR.DOWN?a=-s:r==eR.LEFT?o=-s:r==eR.RIGHT?o=s:a=s;let l=[o,a];(0,eg.rotate)(l,n.getRotation()),(0,eu.pan)(n,l,this.duration_),i.preventDefault(),t=!0;}}return!t;}}class eD extends eu.default{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(e){return!(0,ep.platformModifierKey)(e)&&(0,ep.targetNotEditable)(e);},this.delta_=e.delta?e.delta:1,this.duration_=void 0!==e.duration?e.duration:100;}handleEvent(e){let t=!1;if(e.type==S.default.KEYDOWN||e.type==S.default.KEYPRESS){let i=e.originalEvent,r=i.key;if(this.condition_(e)&&("+"===r||"-"===r)){let n=e.map,s="+"===r?this.delta_:-this.delta_,o=n.getView();(0,eu.zoomByDelta)(o,s,void 0,this.duration_),i.preventDefault(),t=!0;}}return!t;}}var eO=i("4c2caf7c");class eP extends eu.default{constructor(e){super(e=e||{}),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=void 0!==e.maxDelta?e.maxDelta:1,this.duration_=void 0!==e.duration?e.duration:250,this.timeout_=void 0!==e.timeout?e.timeout:80,this.useAnchor_=void 0===e.useAnchor||e.useAnchor,this.constrainResolution_=void 0!==e.constrainResolution&&e.constrainResolution;let t=e.condition?e.condition:ep.always;this.condition_=e.onFocusOnly?(0,ep.all)(ep.focusWithTabindex,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300;}endInteraction_(){this.trackpadTimeoutId_=void 0;let e=this.getMap();e&&e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null);}handleEvent(e){let t;if(!this.condition_(e)||e.type!==S.default.WHEEL)return!0;let i=e.map,r=e.originalEvent;if(r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel),e.type==S.default.WHEEL&&(t=r.deltaY,D.FIREFOX&&r.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(t/=D.DEVICE_PIXEL_RATIO),r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(t*=40)),0===t)return!1;this.lastDelta_=t;let n=Date.now();void 0===this.startTime_&&(this.startTime_=n),(!this.mode_||n-this.startTime_>this.trackpadEventGap_)&&(this.mode_=4>Math.abs(t)?"trackpad":"wheel");let s=i.getView();if("trackpad"===this.mode_&&!(s.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(s.getAnimating()&&s.cancelAnimations(),s.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),s.adjustZoom(-t/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=n,!1;this.totalDelta_+=t;let o=Math.max(this.timeout_-(n-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),o),!1;}handleWheelZoom_(e){let t=e.getView();t.getAnimating()&&t.cancelAnimations();let i=-(0,eO.clamp)(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),(0,eu.zoomByDelta)(t,i,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0;}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null);}}class eM extends ef.default{constructor(e){let t=e=e||{};t.stopDown||(t.stopDown=ee.FALSE),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==e.threshold?e.threshold:.3,this.duration_=void 0!==e.duration?e.duration:250;}handleDragEvent(e){let t=0,i=this.targetPointers[0],r=this.targetPointers[1],n=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(void 0!==this.lastAngle_){let e=n-this.lastAngle_;this.rotationDelta_+=e,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=e;}this.lastAngle_=n;let s=e.map,o=s.getView();o.getConstraints().rotation!==ey.disable&&(this.anchor_=s.getCoordinateFromPixelInternal(s.getEventPixel((0,ef.centroid)(this.targetPointers))),this.rotating_&&(s.render(),o.adjustRotationInternal(t,this.anchor_)));}handleUpEvent(e){return!(this.targetPointers.length<2)||(e.map.getView().endInteraction(this.duration_),!1);}handleDownEvent(e){if(this.targetPointers.length>=2){let t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0;}return!1;}}class ek extends ef.default{constructor(e){let t=e=e||{};t.stopDown||(t.stopDown=ee.FALSE),super(t),this.anchor_=null,this.duration_=void 0!==e.duration?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1;}handleDragEvent(e){let t=1,i=this.targetPointers[0],r=this.targetPointers[1],n=i.clientX-r.clientX,s=i.clientY-r.clientY,o=Math.sqrt(n*n+s*s);void 0!==this.lastDistance_&&(t=this.lastDistance_/o),this.lastDistance_=o;let a=e.map,l=a.getView();1!=t&&(this.lastScaleDelta_=t),this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel((0,ef.centroid)(this.targetPointers))),a.render(),l.adjustResolutionInternal(t,this.anchor_);}handleUpEvent(e){if(this.targetPointers.length<2){let t=e.map.getView(),i=this.lastScaleDelta_>1?1:-1;return t.endInteraction(this.duration_,i),!1;}return!0;}handleDownEvent(e){if(this.targetPointers.length>=2){let t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0;}return!1;}}var eF=i("7ed015fb"),eN=i("24a6054b"),ez=r._(eN);class eK extends y.default{constructor(e,t){super(e),this.layer=t;}}let eB="layers";class eG extends ez.default{constructor(e){let t=Object.assign({},e=e||{});delete t.layers;let i=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(eB,this.handleLayersChanged_),i?Array.isArray(i)?i=new x(i.slice(),{unique:!0}):(0,G.assert)("function"==typeof i.getArray,"Expected `layers` to be an array or a `Collection`"):i=new x(void 0,{unique:!0}),this.setLayers(i);}handleLayerChange_(){this.changed();}handleLayersChanged_(){this.layersListenerKeys_.forEach(I.unlistenByKey),this.layersListenerKeys_.length=0;let e=this.getLayers();for(let t in this.layersListenerKeys_.push((0,I.listen)(e,p.ADD,this.handleLayersAdd_,this),(0,I.listen)(e,p.REMOVE,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[t].forEach(I.unlistenByKey);(0,U.clear)(this.listenerKeys_);let t=e.getArray();for(let e=0,i=t.length;e<i;e++){let i=t[e];this.registerLayerListeners_(i),this.dispatchEvent(new eK("addlayer",i));}this.changed();}registerLayerListeners_(e){let t=[(0,I.listen)(e,z.default.PROPERTYCHANGE,this.handleLayerChange_,this),(0,I.listen)(e,S.default.CHANGE,this.handleLayerChange_,this)];e instanceof eG&&t.push((0,I.listen)(e,"addlayer",this.handleLayerGroupAdd_,this),(0,I.listen)(e,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[(0,eF.getUid)(e)]=t;}handleLayerGroupAdd_(e){this.dispatchEvent(new eK("addlayer",e.layer));}handleLayerGroupRemove_(e){this.dispatchEvent(new eK("removelayer",e.layer));}handleLayersAdd_(e){let t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new eK("addlayer",t)),this.changed();}handleLayersRemove_(e){let t=e.element,i=(0,eF.getUid)(t);this.listenerKeys_[i].forEach(I.unlistenByKey),delete this.listenerKeys_[i],this.dispatchEvent(new eK("removelayer",t)),this.changed();}getLayers(){return this.get(eB);}setLayers(e){let t=this.getLayers();if(t){let e=t.getArray();for(let t=0,i=e.length;t<i;++t)this.dispatchEvent(new eK("removelayer",e[t]));}this.set(eB,e);}getLayersArray(e){return e=void 0!==e?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e);}),e;}getLayerStatesArray(e){let t=void 0!==e?e:[],i=t.length;this.getLayers().forEach(function(e){e.getLayerStatesArray(t);});let r=this.getLayerState(),n=r.zIndex;e||void 0!==r.zIndex||(n=0);for(let e=i,s=t.length;e<s;e++){let i=t[e];i.opacity*=r.opacity,i.visible=i.visible&&r.visible,i.maxResolution=Math.min(i.maxResolution,r.maxResolution),i.minResolution=Math.max(i.minResolution,r.minResolution),i.minZoom=Math.max(i.minZoom,r.minZoom),i.maxZoom=Math.min(i.maxZoom,r.maxZoom),void 0!==r.extent&&(void 0!==i.extent?i.extent=(0,el.getIntersection)(i.extent,r.extent):i.extent=r.extent),void 0===i.zIndex&&(i.zIndex=n);}return t;}getSourceState(){return"ready";}}var eU=i("2ef93964"),eV=n._(eU),ej=i("688838c3"),eW=i("2f975123"),eX=r._(eW);function eH(e,t,i){let r=e[t];e[t]=e[i],e[i]=r;}class eq{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear();}all(){return this._all(this.data,[]);}search(e){let t=this.data,i=[];if(!e3(e,t))return i;let r=this.toBBox,n=[];for(;t;){for(let s=0;s<t.children.length;s++){let o=t.children[s],a=t.leaf?r(o):o;e3(e,a)&&(t.leaf?i.push(o):e2(e,a)?this._all(o,i):n.push(o));}t=n.pop();}return i;}collides(e){let t=this.data;if(!e3(e,t))return!1;let i=[];for(;t;){for(let r=0;r<t.children.length;r++){let n=t.children[r],s=t.leaf?this.toBBox(n):n;if(e3(e,s)){if(t.leaf||e2(e,s))return!0;i.push(n);}}t=i.pop();}return!1;}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let t=0;t<e.length;t++)this.insert(e[t]);return this;}let t=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length){if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){let e=this.data;this.data=t,t=e;}this._insert(t,this.data.height-t.height-1,!0);}}else this.data=t;return this;}insert(e){return e&&this._insert(e,this.data.height-1),this;}clear(){return this.data=e5([]),this;}remove(e,t){let i,r,n;if(!e)return this;let s=this.data,o=this.toBBox(e),a=[],l=[];for(;s||a.length;){if(s||(s=a.pop(),r=a[a.length-1],i=l.pop(),n=!0),s.leaf){let i=function(e,t,i){if(!i)return t.indexOf(e);for(let r=0;r<t.length;r++)if(i(e,t[r]))return r;return -1;}(e,s.children,t);if(-1!==i){s.children.splice(i,1),a.push(s),this._condense(a);break;}}!n&&!s.leaf&&e2(s,o)?(a.push(s),l.push(i),i=0,r=s,s=s.children[0]):r?(i++,s=r.children[i],n=!1):s=null;}return this;}toBBox(e){return e;}compareMinX(e,t){return e.minX-t.minX;}compareMinY(e,t){return e.minY-t.minY;}toJSON(){return this.data;}fromJSON(e){return this.data=e,this;}_all(e,t){let i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t;}_build(e,t,i,r){let n;let s=i-t+1,o=this._maxEntries;if(s<=o)return eY(n=e5(e.slice(t,i+1)),this.toBBox),n;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),(n=e5([])).leaf=!1,n.height=r;let a=Math.ceil(s/o),l=a*Math.ceil(Math.sqrt(o));e6(e,t,i,l,this.compareMinX);for(let s=t;s<=i;s+=l){let t=Math.min(s+l-1,i);e6(e,s,t,a,this.compareMinY);for(let i=s;i<=t;i+=a){let s=Math.min(i+a-1,t);n.children.push(this._build(e,i,s,r-1));}}return eY(n,this.toBBox),n;}_chooseSubtree(e,t,i,r){for(;;){let n;if(r.push(t),t.leaf||r.length-1===i)break;let s=1/0,o=1/0;for(let i=0;i<t.children.length;i++){let r=t.children[i],a=e0(r),l=(Math.max(r.maxX,e.maxX)-Math.min(r.minX,e.minX))*(Math.max(r.maxY,e.maxY)-Math.min(r.minY,e.minY))-a;l<o?(o=l,s=a<s?a:s,n=r):l===o&&a<s&&(s=a,n=r);}t=n||t.children[0];}return t;}_insert(e,t,i){let r=i?e:this.toBBox(e),n=[],s=this._chooseSubtree(r,this.data,t,n);for(s.children.push(e),eZ(s,r);t>=0;)if(n[t].children.length>this._maxEntries)this._split(n,t),t--;else break;this._adjustParentBBoxes(r,n,t);}_split(e,t){let i=e[t],r=i.children.length,n=this._minEntries;this._chooseSplitAxis(i,n,r);let s=this._chooseSplitIndex(i,n,r),o=e5(i.children.splice(s,i.children.length-s));o.height=i.height,o.leaf=i.leaf,eY(i,this.toBBox),eY(o,this.toBBox),t?e[t-1].children.push(o):this._splitRoot(i,o);}_splitRoot(e,t){this.data=e5([e,t]),this.data.height=e.height+1,this.data.leaf=!1,eY(this.data,this.toBBox);}_chooseSplitIndex(e,t,i){let r;let n=1/0,s=1/0;for(let o=t;o<=i-t;o++){let t=e$(e,0,o,this.toBBox),a=e$(e,o,i,this.toBBox),l=function(e,t){let i=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY);return Math.max(0,Math.min(e.maxX,t.maxX)-i)*Math.max(0,Math.min(e.maxY,t.maxY)-r);}(t,a),h=e0(t)+e0(a);l<n?(n=l,r=o,s=h<s?h:s):l===n&&h<s&&(s=h,r=o);}return r||i-t;}_chooseSplitAxis(e,t,i){let r=e.leaf?this.compareMinX:eJ,n=e.leaf?this.compareMinY:eQ;this._allDistMargin(e,t,i,r)<this._allDistMargin(e,t,i,n)&&e.children.sort(r);}_allDistMargin(e,t,i,r){e.children.sort(r);let n=this.toBBox,s=e$(e,0,t,n),o=e$(e,i-t,i,n),a=e1(s)+e1(o);for(let r=t;r<i-t;r++){let t=e.children[r];eZ(s,e.leaf?n(t):t),a+=e1(s);}for(let r=i-t-1;r>=t;r--){let t=e.children[r];eZ(o,e.leaf?n(t):t),a+=e1(o);}return a;}_adjustParentBBoxes(e,t,i){for(let r=i;r>=0;r--)eZ(t[r],e);}_condense(e){for(let t=e.length-1,i;t>=0;t--)0===e[t].children.length?t>0?(i=e[t-1].children).splice(i.indexOf(e[t]),1):this.clear():eY(e[t],this.toBBox);}}function eY(e,t){e$(e,0,e.children.length,t,e);}function e$(e,t,i,r,n){n||(n=e5(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(let s=t;s<i;s++){let t=e.children[s];eZ(n,e.leaf?r(t):t);}return n;}function eZ(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e;}function eJ(e,t){return e.minX-t.minX;}function eQ(e,t){return e.minY-t.minY;}function e0(e){return(e.maxX-e.minX)*(e.maxY-e.minY);}function e1(e){return e.maxX-e.minX+(e.maxY-e.minY);}function e2(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY;}function e3(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY;}function e5(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};}function e6(e,t,i,r,n){let s=[t,i];for(;s.length;){if((i=s.pop())-(t=s.pop())<=r)continue;let o=t+Math.ceil((i-t)/r/2)*r;!function e(t,i,r=0,n=t.length-1,s=function(e,t){return e<t?-1:e>t?1:0;}){for(;n>r;){if(n-r>600){let o=n-r+1,a=i-r+1,l=Math.log(o),h=.5*Math.exp(2*l/3),d=.5*Math.sqrt(l*h*(o-h)/o)*(a-o/2<0?-1:1),u=Math.max(r,Math.floor(i-a*h/o+d)),c=Math.min(n,Math.floor(i+(o-a)*h/o+d));e(t,i,u,c,s);}let o=t[i],a=r,l=n;for(eH(t,r,i),s(t[n],o)>0&&eH(t,r,n);a<l;){for(eH(t,a,l),a++,l--;0>s(t[a],o);)a++;for(;s(t[l],o)>0;)l--;}0===s(t[r],o)?eH(t,r,l):eH(t,++l,n),l<=i&&(r=l+1),i<=l&&(n=l-1);}}(e,o,t,i,n),s.push(t,o,o,i);}}var e4=i("f5eb33d2"),e8=i("9b2ed12b");let e7=0,e9=1<<e7++,te=1<<e7++,tt=1<<e7++,ti=1<<e7++,tr=1<<e7++,tn=1<<e7++,ts=Math.pow(2,e7)-1,to={[e9]:"boolean",[te]:"number",[tt]:"string",[ti]:"color",[tr]:"number[]",[tn]:"size"},ta=Object.keys(to).map(Number).sort($.ascending);function tl(e){let t=[];for(let i of ta)(e&i)===i&&t.push(to[i]);return 0===t.length?"untyped":t.length<3?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t[t.length-1];}class th{constructor(e,t){if(!(e in to))throw Error(`literal expressions must have a specific type, got ${tl(e)}`);this.type=e,this.value=t;}}class td{constructor(e,t,...i){this.type=e,this.operator=t,this.args=i;}}function tu(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1};}function tc(e,t,i){switch(typeof e){case"boolean":if(t===tt)return new th(tt,e?"true":"false");if((t&e9)!==e9)throw Error(`got a boolean, but expected ${tl(t)}`);return new th(e9,e);case"number":if(t===tn)return new th(tn,(0,e8.toSize)(e));if(t===e9)return new th(e9,!!e);if(t===tt)return new th(tt,e.toString());if((t&te)!==te)throw Error(`got a number, but expected ${tl(t)}`);return new th(te,e);case"string":if(t===ti)return new th(ti,(0,e4.fromString)(e));if(t===e9)return new th(e9,!!e);if((t&tt)!==tt)throw Error(`got a string, but expected ${tl(t)}`);return new th(tt,e);}if(!Array.isArray(e))throw Error("expression must be an array or a primitive value");if(0===e.length)throw Error("empty expression");if("string"==typeof e[0])return function(e,t,i){let r=e[0],n=tp[r];if(!n)throw Error(`unknown operator: ${r}`);return n(e,t,i);}(e,t,i);for(let t of e)if("number"!=typeof t)throw Error("expected an array of numbers");if(t===tn){if(2!==e.length)throw Error(`expected an array of two values for a size, got ${e.length}`);return new th(tn,e);}if(t===ti){if(3===e.length)return new th(ti,[...e,1]);if(4===e.length)return new th(ti,e);throw Error(`expected an array of 3 or 4 values for a color, got ${e.length}`);}if((t&tr)!==tr)throw Error(`got an array of numbers, but expected ${tl(t)}`);return new th(tr,e);}let tg={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},tp={[tg.Get]:tw(ty(1,1/0),t_),[tg.Var]:tw(ty(1,1),function(e,t,i){let r=e[1];if("string"!=typeof r)throw Error("expected a string argument for var operation");return i.variables.add(r),[new th(tt,r)];}),[tg.Has]:tw(ty(1,1/0),t_),[tg.Id]:tw(function(e,t,i){i.featureId=!0;},tm),[tg.Concat]:tw(ty(2,1/0),tE(tt)),[tg.GeometryType]:tw(function(e,t,i){i.geometryType=!0;},tm),[tg.LineMetric]:tw(tm),[tg.Resolution]:tw(tf,tm),[tg.Zoom]:tw(tf,tm),[tg.Time]:tw(tf,tm),[tg.Any]:tw(ty(2,1/0),tE(e9)),[tg.All]:tw(ty(2,1/0),tE(e9)),[tg.Not]:tw(ty(1,1),tE(e9)),[tg.Equal]:tw(ty(2,2),tE(ts)),[tg.NotEqual]:tw(ty(2,2),tE(ts)),[tg.GreaterThan]:tw(ty(2,2),tE(te)),[tg.GreaterThanOrEqualTo]:tw(ty(2,2),tE(te)),[tg.LessThan]:tw(ty(2,2),tE(te)),[tg.LessThanOrEqualTo]:tw(ty(2,2),tE(te)),[tg.Multiply]:tw(ty(2,1/0),tv),[tg.Coalesce]:tw(ty(2,1/0),tv),[tg.Divide]:tw(ty(2,2),tE(te)),[tg.Add]:tw(ty(2,1/0),tE(te)),[tg.Subtract]:tw(ty(2,2),tE(te)),[tg.Clamp]:tw(ty(3,3),tE(te)),[tg.Mod]:tw(ty(2,2),tE(te)),[tg.Pow]:tw(ty(2,2),tE(te)),[tg.Abs]:tw(ty(1,1),tE(te)),[tg.Floor]:tw(ty(1,1),tE(te)),[tg.Ceil]:tw(ty(1,1),tE(te)),[tg.Round]:tw(ty(1,1),tE(te)),[tg.Sin]:tw(ty(1,1),tE(te)),[tg.Cos]:tw(ty(1,1),tE(te)),[tg.Atan]:tw(ty(1,2),tE(te)),[tg.Sqrt]:tw(ty(1,1),tE(te)),[tg.Match]:tw(ty(4,1/0),tx,function(e,t,i){let r=e.length-1,n=tt|te|e9,s=tc(e[1],n,i),o=tc(e[e.length-1],t,i),a=Array(r-2);for(let t=0;t<r-2;t+=2){try{let r=tc(e[t+2],s.type,i);a[t]=r;}catch(e){throw Error(`failed to parse argument ${t+1} of match expression: ${e.message}`);}try{let r=tc(e[t+3],o.type,i);a[t+1]=r;}catch(e){throw Error(`failed to parse argument ${t+2} of match expression: ${e.message}`);}}return[s,...a,o];}),[tg.Between]:tw(ty(3,3),tE(te)),[tg.Interpolate]:tw(ty(6,1/0),tx,function(e,t,i){let r,n;let s=e[1];switch(s[0]){case"linear":r=1;break;case"exponential":let o=s[1];if("number"!=typeof o||o<=0)throw Error(`expected a number base for exponential interpolation, got ${JSON.stringify(o)} instead`);r=o;break;default:throw Error(`invalid interpolation type: ${JSON.stringify(s)}`);}let a=new th(te,r);try{n=tc(e[2],te,i);}catch(e){throw Error(`failed to parse argument 1 in interpolate expression: ${e.message}`);}let l=Array(e.length-3);for(let r=0;r<l.length;r+=2){try{let t=tc(e[r+3],te,i);l[r]=t;}catch(e){throw Error(`failed to parse argument ${r+2} for interpolate expression: ${e.message}`);}try{let n=tc(e[r+4],t,i);l[r+1]=n;}catch(e){throw Error(`failed to parse argument ${r+3} for interpolate expression: ${e.message}`);}}return[a,n,...l];}),[tg.Case]:tw(ty(3,1/0),function(e,t,i){let r=e[0],n=e.length-1;if(n%2==0)throw Error(`expected an odd number of arguments for ${r}, got ${n} instead`);},function(e,t,i){let r=tc(e[e.length-1],t,i),n=Array(e.length-1);for(let t=0;t<n.length-1;t+=2){try{let r=tc(e[t+1],e9,i);n[t]=r;}catch(e){throw Error(`failed to parse argument ${t} of case expression: ${e.message}`);}try{let s=tc(e[t+2],r.type,i);n[t+1]=s;}catch(e){throw Error(`failed to parse argument ${t+1} of case expression: ${e.message}`);}}return n[n.length-1]=r,n;}),[tg.In]:tw(ty(2,2),function(e,t,i){let r,n=e[2];if(!Array.isArray(n))throw Error('the second argument for the "in" operator must be an array');if("string"==typeof n[0]){if("literal"!==n[0])throw Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(n[1]))throw Error('failed to parse "in" expression: the literal operator must be followed by an array');n=n[1],r=tt;}else r=te;let s=Array(n.length);for(let e=0;e<s.length;e++)try{let t=tc(n[e],r,i);s[e]=t;}catch(t){throw Error(`failed to parse haystack item ${e} for "in" expression: ${t.message}`);}return[tc(e[1],r,i),...s];}),[tg.Number]:tw(ty(1,1/0),tE(ts)),[tg.String]:tw(ty(1,1/0),tE(ts)),[tg.Array]:tw(ty(1,1/0),tE(te)),[tg.Color]:tw(ty(1,4),tE(te)),[tg.Band]:tw(ty(1,3),tE(te)),[tg.Palette]:tw(ty(2,2),function(e,t,i){let r;try{r=tc(e[1],te,i);}catch(e){throw Error(`failed to parse first argument in palette expression: ${e.message}`);}let n=e[2];if(!Array.isArray(n))throw Error("the second argument of palette must be an array");let s=Array(n.length);for(let e=0;e<s.length;e++){let t;try{t=tc(n[e],ti,i);}catch(t){throw Error(`failed to parse color at index ${e} in palette expression: ${t.message}`);}if(!(t instanceof th))throw Error(`the palette color at index ${e} must be a literal value`);s[e]=t;}return[r,...s];}),[tg.ToString]:tw(ty(1,1),tE(e9|te|tt|ti))};function t_(e,t,i){let r=e.length-1,n=Array(r);for(let t=0;t<r;++t){let r=e[t+1];switch(typeof r){case"number":n[t]=new th(te,r);break;case"string":n[t]=new th(tt,r);break;default:throw Error(`expected a string key or numeric array index for a get operation, got ${r}`);}0===t&&i.properties.add(String(r));}return n;}function tf(e,t,i){i.mapState=!0;}function tm(e,t,i){let r=e[0];if(1!==e.length)throw Error(`expected no arguments for ${r} operation`);return[];}function ty(e,t){return function(i,r,n){let s=i[0],o=i.length-1;if(e===t){if(o!==e)throw Error(`expected ${e} argument${1===e?"":"s"} for ${s}, got ${o}`);}else if(o<e||o>t){let i=t===1/0?`${e} or more`:`${e} to ${t}`;throw Error(`expected ${i} arguments for ${s}, got ${o}`);}};}function tv(e,t,i){let r=e.length-1,n=Array(r);for(let s=0;s<r;++s){let r=tc(e[s+1],t,i);n[s]=r;}return n;}function tE(e){return function(t,i,r){let n=t.length-1,s=Array(n);for(let i=0;i<n;++i){let n=tc(t[i+1],e,r);s[i]=n;}return s;};}function tx(e,t,i){let r=e[0],n=e.length-1;if(n%2==1)throw Error(`expected an even number of arguments for operation ${r}, got ${n} instead`);}function tw(...e){return function(t,i,r){let n;let s=t[0];for(let s=0;s<e.length;s++){let o=e[s](t,i,r);if(s==e.length-1){if(!o)throw Error("expected last argument validator to return the parsed args");n=o;}}return new td(i,s,...n);};}function tb(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""};}function tC(e,t,i){return function e(t,i){if(t instanceof th){if(t.type===ti&&"string"==typeof t.value){let e=(0,e4.fromString)(t.value);return function(){return e;};}return function(){return t.value;};}let r=t.operator;switch(r){case tg.Number:case tg.String:case tg.Coalesce:return function(t,i){let r=t.operator,n=t.args.length,s=Array(n);for(let r=0;r<n;++r)s[r]=e(t.args[r],i);switch(r){case tg.Coalesce:return e=>{for(let t=0;t<n;++t){let i=s[t](e);if(null!=i)return i;}throw Error("Expected one of the values to be non-null");};case tg.Number:case tg.String:return e=>{for(let t=0;t<n;++t){let i=s[t](e);if(typeof i===r)return i;}throw Error(`Expected one of the values to be a ${r}`);};default:throw Error(`Unsupported assertion operator ${r}`);}}(t,i);case tg.Get:case tg.Var:case tg.Has:return function(e,t){let i=e.args[0].value;switch(e.operator){case tg.Get:return t=>{let r=e.args,n=t.properties[i];for(let e=1,t=r.length;e<t;++e)n=n[r[e].value];return n;};case tg.Var:return e=>e.variables[i];case tg.Has:return t=>{let r=e.args;if(!(i in t.properties))return!1;let n=t.properties[i];for(let e=1,t=r.length;e<t;++e){let t=r[e].value;if(!n||!Object.hasOwn(n,t))return!1;n=n[t];}return!0;};default:throw Error(`Unsupported accessor operator ${e.operator}`);}}(t,0);case tg.Id:return e=>e.featureId;case tg.GeometryType:return e=>e.geometryType;case tg.Concat:{let r=t.args.map(t=>e(t,i));return e=>"".concat(...r.map(t=>t(e).toString()));}case tg.Resolution:return e=>e.resolution;case tg.Any:case tg.All:case tg.Between:case tg.In:case tg.Not:return function(t,i){let r=t.operator,n=t.args.length,s=Array(n);for(let r=0;r<n;++r)s[r]=e(t.args[r],i);switch(r){case tg.Any:return e=>{for(let t=0;t<n;++t)if(s[t](e))return!0;return!1;};case tg.All:return e=>{for(let t=0;t<n;++t)if(!s[t](e))return!1;return!0;};case tg.Between:return e=>{let t=s[0](e),i=s[1](e),r=s[2](e);return t>=i&&t<=r;};case tg.In:return e=>{let t=s[0](e);for(let i=1;i<n;++i)if(t===s[i](e))return!0;return!1;};case tg.Not:return e=>!s[0](e);default:throw Error(`Unsupported logical operator ${r}`);}}(t,i);case tg.Equal:case tg.NotEqual:case tg.LessThan:case tg.LessThanOrEqualTo:case tg.GreaterThan:case tg.GreaterThanOrEqualTo:return function(t,i){let r=t.operator,n=e(t.args[0],i),s=e(t.args[1],i);switch(r){case tg.Equal:return e=>n(e)===s(e);case tg.NotEqual:return e=>n(e)!==s(e);case tg.LessThan:return e=>n(e)<s(e);case tg.LessThanOrEqualTo:return e=>n(e)<=s(e);case tg.GreaterThan:return e=>n(e)>s(e);case tg.GreaterThanOrEqualTo:return e=>n(e)>=s(e);default:throw Error(`Unsupported comparison operator ${r}`);}}(t,i);case tg.Multiply:case tg.Divide:case tg.Add:case tg.Subtract:case tg.Clamp:case tg.Mod:case tg.Pow:case tg.Abs:case tg.Floor:case tg.Ceil:case tg.Round:case tg.Sin:case tg.Cos:case tg.Atan:case tg.Sqrt:return function(t,i){let r=t.operator,n=t.args.length,s=Array(n);for(let r=0;r<n;++r)s[r]=e(t.args[r],i);switch(r){case tg.Multiply:return e=>{let t=1;for(let i=0;i<n;++i)t*=s[i](e);return t;};case tg.Divide:return e=>s[0](e)/s[1](e);case tg.Add:return e=>{let t=0;for(let i=0;i<n;++i)t+=s[i](e);return t;};case tg.Subtract:return e=>s[0](e)-s[1](e);case tg.Clamp:return e=>{let t=s[0](e),i=s[1](e);if(t<i)return i;let r=s[2](e);return t>r?r:t;};case tg.Mod:return e=>s[0](e)%s[1](e);case tg.Pow:return e=>Math.pow(s[0](e),s[1](e));case tg.Abs:return e=>Math.abs(s[0](e));case tg.Floor:return e=>Math.floor(s[0](e));case tg.Ceil:return e=>Math.ceil(s[0](e));case tg.Round:return e=>Math.round(s[0](e));case tg.Sin:return e=>Math.sin(s[0](e));case tg.Cos:return e=>Math.cos(s[0](e));case tg.Atan:if(2===n)return e=>Math.atan2(s[0](e),s[1](e));return e=>Math.atan(s[0](e));case tg.Sqrt:return e=>Math.sqrt(s[0](e));default:throw Error(`Unsupported numeric operator ${r}`);}}(t,i);case tg.Case:return function(t,i){let r=t.args.length,n=Array(r);for(let s=0;s<r;++s)n[s]=e(t.args[s],i);return e=>{for(let t=0;t<r-1;t+=2)if(n[t](e))return n[t+1](e);return n[r-1](e);};}(t,i);case tg.Match:return function(t,i){let r=t.args.length,n=Array(r);for(let s=0;s<r;++s)n[s]=e(t.args[s],i);return e=>{let t=n[0](e);for(let i=1;i<r;i+=2)if(t===n[i](e))return n[i+1](e);return n[r-1](e);};}(t,i);case tg.Interpolate:return function(t,i){let r=t.args.length,n=Array(r);for(let s=0;s<r;++s)n[s]=e(t.args[s],i);return e=>{let t,i;let s=n[0](e),o=n[1](e);for(let a=2;a<r;a+=2){let r=n[a](e),l=n[a+1](e),h=Array.isArray(l);if(h&&(l=(0,e4.withAlpha)(l)),r>=o){if(2===a)return l;if(h)return function(e,t,i,r,n,s){if(0==n-i)return r;let o=(0,e4.rgbaToLcha)(r),a=(0,e4.rgbaToLcha)(s),l=a[2]-o[2];l>180?l-=360:l<-180&&(l+=360);let h=[tT(e,t,i,o[0],n,a[0]),tT(e,t,i,o[1],n,a[1]),o[2]+tT(e,t,i,0,n,l),tT(e,t,i,r[3],n,s[3])];return(0,e4.normalize)((0,e4.lchaToRgba)(h));}(s,o,t,i,r,l);return tT(s,o,t,i,r,l);}t=r,i=l;}return i;};}(t,i);case tg.ToString:return function(t,i){let r=t.operator,n=t.args.length,s=Array(n);for(let r=0;r<n;++r)s[r]=e(t.args[r],i);if(r===tg.ToString)return e=>{let i=s[0](e);return t.args[0].type===ti?(0,e4.toString)(i):i.toString();};throw Error(`Unsupported convert operator ${r}`);}(t,i);default:throw Error(`Unsupported operator ${r}`);}}(tc(e,t,i),i);}function tT(e,t,i,r,n,s){let o=n-i;if(0===o)return r;let a=t-i;return r+(1===e?a/o:(Math.pow(e,a)-1)/(Math.pow(e,o)-1))*(s-r);}var tL=i("635c7844"),tS=r._(tL),tA=i("71f18cc3"),tR=n._(tA),tI=i("d8aabc92");function tD(e){return e?Array.isArray(e)?(0,e4.toString)(e):"object"==typeof e&&"src"in e?function(e){if(!e.offset||!e.size)return tI.shared.getPattern(e.src,"anonymous",e.color);let t=e.src+":"+e.offset,i=tI.shared.getPattern(t,void 0,e.color);if(i)return i;let r=tI.shared.get(e.src,"anonymous",null);if(r.getImageState()!==tS.default.LOADED)return null;let n=(0,Q.createCanvasContext2D)(e.size[0],e.size[1]);return n.drawImage(r.getImage(1),e.offset[0],e.offset[1],e.size[0],e.size[1],0,0,e.size[0],e.size[1]),(0,tR.get)(n.canvas,t,void 0,tS.default.LOADED,e.color,!0),tI.shared.getPattern(t,void 0,e.color);}(e):e:null;}let tO="#000",tP="round",tM="round",tk=new f.default;class tF{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=(0,e8.toSize)(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode;}clone(){let e=this.getScale();return new tF({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});}getOpacity(){return this.opacity_;}getRotateWithView(){return this.rotateWithView_;}getRotation(){return this.rotation_;}getScale(){return this.scale_;}getScaleArray(){return this.scaleArray_;}getDisplacement(){return this.displacement_;}getDeclutterMode(){return this.declutterMode_;}getAnchor(){return(0,eF.abstract)();}getImage(e){return(0,eF.abstract)();}getHitDetectionImage(){return(0,eF.abstract)();}getPixelRatio(e){return 1;}getImageState(){return(0,eF.abstract)();}getImageSize(){return(0,eF.abstract)();}getOrigin(){return(0,eF.abstract)();}getSize(){return(0,eF.abstract)();}setDisplacement(e){this.displacement_=e;}setOpacity(e){this.opacity_=e;}setRotateWithView(e){this.rotateWithView_=e;}setRotation(e){this.rotation_=e;}setScale(e){this.scale_=e,this.scaleArray_=(0,e8.toSize)(e);}listenImageChange(e){(0,eF.abstract)();}load(){(0,eF.abstract)();}unlistenImageChange(e){(0,eF.abstract)();}ready(){return Promise.resolve();}}class tN extends tF{constructor(e){super({opacity:1,rotateWithView:void 0!==e.rotateWithView&&e.rotateWithView,rotation:void 0!==e.rotation?e.rotation:0,scale:void 0!==e.scale?e.scale:1,displacement:void 0!==e.displacement?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=void 0!==e.fill?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=void 0!==e.angle?e.angle:0,this.stroke_=void 0!==e.stroke?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?tS.default.LOADING:tS.default.LOADED,this.imageState_===tS.default.LOADING&&this.ready().then(()=>this.imageState_=tS.default.LOADED),this.render();}clone(){let e=this.getScale(),t=new tN({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t;}getAnchor(){let e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]];}getAngle(){return this.angle_;}getFill(){return this.fill_;}setFill(e){this.fill_=e,this.render();}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_;}getImage(e){var t,i;let r=null===(t=this.fill_)||void 0===t?void 0:t.getKey(),n=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${r}`+Object.values(this.renderOptions_).join(","),s=null===(i=tI.shared.get(n,null,null))||void 0===i?void 0:i.getImage(1);if(!s){let t=this.renderOptions_,i=Math.ceil(t.size*e),r=(0,Q.createCanvasContext2D)(i,i);this.draw_(t,r,e),s=r.canvas,tI.shared.set(n,null,null,new tR.default(s,void 0,null,tS.default.LOADED,null));}return s;}getPixelRatio(e){return e;}getImageSize(){return this.size_;}getImageState(){return this.imageState_;}getOrigin(){return this.origin_;}getPoints(){return this.points_;}getRadius(){return this.radius;}getRadius2(){return this.radius2_;}getSize(){return this.size_;}getStroke(){return this.stroke_;}setStroke(e){this.stroke_=e,this.render();}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,i){if(0===t||this.points_===1/0||"bevel"!==e&&"miter"!==e)return t;let r=this.radius,n=void 0===this.radius2_?r:this.radius2_;if(r<n){let e=r;r=n,n=e;}let s=2*Math.PI/(void 0===this.radius2_?this.points_:2*this.points_),o=n*Math.sin(s),a=r-Math.sqrt(n*n-o*o),l=Math.sqrt(o*o+a*a),h=l/o;if("miter"===e&&h<=i)return h*t;let d=t/2/h,u=t/2*(a/l),c=Math.sqrt((r+d)*(r+d)+u*u)-r;if(void 0===this.radius2_||"bevel"===e)return 2*c;let g=r*Math.sin(s),p=n-Math.sqrt(r*r-g*g),_=Math.sqrt(g*g+p*p)/g;return _<=i?2*Math.max(c,_*t/2-n-r):2*c;}createRenderOptions(){let e,t=tP,i=tM,r=0,n=null,s=0,o=0;this.stroke_&&(e=tD(this.stroke_.getColor()??"#000"),o=this.stroke_.getWidth()??1,n=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,i=this.stroke_.getLineJoin()??tM,t=this.stroke_.getLineCap()??tP,r=this.stroke_.getMiterLimit()??10);let a=this.calculateLineJoinSize_(i,o,r);return{strokeStyle:e,strokeWidth:o,size:Math.ceil(2*Math.max(this.radius,this.radius2_||0)+a),lineCap:t,lineDash:n,lineDashOffset:s,lineJoin:i,miterLimit:r};}render(){this.renderOptions_=this.createRenderOptions();let e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e];}draw_(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let e=this.fill_.getColor();null===e&&(e=tO),t.fillStyle=tD(e),t.fill();}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke());}createHitDetectionCanvas_(e){let t;if(this.fill_){let i=this.fill_.getColor(),r=0;"string"==typeof i&&(i=(0,e4.asArray)(i)),null===i?r=1:Array.isArray(i)&&(r=4===i.length?i[3]:1),0===r&&(t=(0,Q.createCanvasContext2D)(e.size,e.size),this.drawHitDetectionCanvas_(e,t));}return t?t.canvas:this.getImage(1);}createPath_(e){let t=this.points_,i=this.radius;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{let r=void 0===this.radius2_?i:this.radius2_;void 0!==this.radius2_&&(t*=2);let n=this.angle_-Math.PI/2,s=2*Math.PI/t;for(let o=0;o<t;o++){let t=n+o*s,a=o%2==0?i:r;e.lineTo(a*Math.cos(t),a*Math.sin(t));}e.closePath();}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=tO,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke());}ready(){return this.fill_?this.fill_.ready():Promise.resolve();}}class tz extends tN{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:void 0!==e.scale?e.scale:1,rotation:void 0!==e.rotation?e.rotation:0,rotateWithView:void 0!==e.rotateWithView&&e.rotateWithView,displacement:void 0!==e.displacement?e.displacement:[0,0],declutterMode:e.declutterMode});}clone(){let e=this.getScale(),t=new tz({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t;}setRadius(e){this.radius=e,this.render();}}class tK{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,void 0!==e.color&&this.setColor(e.color);}clone(){let e=this.getColor();return new tK({color:Array.isArray(e)?e.slice():e||void 0});}getColor(){return this.color_;}setColor(e){if(null!==e&&"object"==typeof e&&"src"in e){let t=(0,tR.get)(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null;}),t.getImageState()===tS.default.IDLE&&t.load(),t.getImageState()===tS.default.LOADING&&(this.patternImage_=t);}this.color_=e;}getKey(){let e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?(0,eF.getUid)(e):"object"==typeof e&&"src"in e?e.src+":"+e.offset:(0,e4.asArray)(e).toString():"";}loading(){return!!this.patternImage_;}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve();}}function tB(e,t,i,r){return void 0!==i&&void 0!==r?[i/e,r/t]:void 0!==i?i/e:void 0!==r?r/t:1;}class tG extends tF{constructor(e){let t;let i=void 0!==(e=e||{}).opacity?e.opacity:1;super({opacity:i,rotation:void 0!==e.rotation?e.rotation:0,scale:void 0!==e.scale?e.scale:1,displacement:void 0!==e.displacement?e.displacement:[0,0],rotateWithView:void 0!==e.rotateWithView&&e.rotateWithView,declutterMode:e.declutterMode}),this.anchor_=void 0!==e.anchor?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=void 0!==e.anchorOrigin?e.anchorOrigin:"top-left",this.anchorXUnits_=void 0!==e.anchorXUnits?e.anchorXUnits:"fraction",this.anchorYUnits_=void 0!==e.anchorYUnits?e.anchorYUnits:"fraction",this.crossOrigin_=void 0!==e.crossOrigin?e.crossOrigin:null;let r=void 0!==e.img?e.img:null,n=e.src;if((0,G.assert)(!(void 0!==n&&r),"`image` and `src` cannot be provided at the same time"),(void 0===n||0===n.length)&&r&&(n=r.src||(0,eF.getUid)(r)),(0,G.assert)(void 0!==n&&n.length>0,"A defined and non-empty `src` or `image` must be provided"),(0,G.assert)(!((void 0!==e.width||void 0!==e.height)&&void 0!==e.scale),"`width` or `height` cannot be provided together with `scale`"),void 0!==e.src?t=tS.default.IDLE:void 0!==r&&(t="complete"in r?r.complete?r.src?tS.default.LOADED:tS.default.IDLE:tS.default.LOADING:tS.default.LOADED),this.color_=void 0!==e.color?(0,e4.asArray)(e.color):null,this.iconImage_=(0,tR.get)(r,n,this.crossOrigin_,t,this.color_),this.offset_=void 0!==e.offset?e.offset:[0,0],this.offsetOrigin_=void 0!==e.offsetOrigin?e.offsetOrigin:"top-left",this.origin_=null,this.size_=void 0!==e.size?e.size:null,this.initialOptions_,void 0!==e.width||void 0!==e.height){let t,i;if(e.size)[t,i]=e.size;else{let r=this.getImage(1);if(r.width&&r.height)t=r.width,i=r.height;else if(r instanceof HTMLImageElement){this.initialOptions_=e;let t=()=>{if(this.unlistenImageChange(t),!this.initialOptions_)return;let i=this.iconImage_.getSize();this.setScale(tB(i[0],i[1],e.width,e.height));};this.listenImageChange(t);return;}}void 0!==t&&this.setScale(tB(t,i,e.width,e.height));}}clone(){let e,t,i;return this.initialOptions_?(t=this.initialOptions_.width,i=this.initialOptions_.height):e=Array.isArray(e=this.getScale())?e.slice():e,new tG({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:i,size:null!==this.size_?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;let t=this.getSize();if("fraction"==this.anchorXUnits_||"fraction"==this.anchorYUnits_){if(!t)return null;e=this.anchor_.slice(),"fraction"==this.anchorXUnits_&&(e[0]*=t[0]),"fraction"==this.anchorYUnits_&&(e[1]*=t[1]);}if("top-left"!=this.anchorOrigin_){if(!t)return null;e===this.anchor_&&(e=this.anchor_.slice()),("top-right"==this.anchorOrigin_||"bottom-right"==this.anchorOrigin_)&&(e[0]=-e[0]+t[0]),("bottom-left"==this.anchorOrigin_||"bottom-right"==this.anchorOrigin_)&&(e[1]=-e[1]+t[1]);}this.normalizedAnchor_=e;}let t=this.getDisplacement(),i=this.getScaleArray();return[e[0]-t[0]/i[0],e[1]+t[1]/i[1]];}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null;}getColor(){return this.color_;}getImage(e){return this.iconImage_.getImage(e);}getPixelRatio(e){return this.iconImage_.getPixelRatio(e);}getImageSize(){return this.iconImage_.getSize();}getImageState(){return this.iconImage_.getImageState();}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage();}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if("top-left"!=this.offsetOrigin_){let t=this.getSize(),i=this.iconImage_.getSize();if(!t||!i)return null;e=e.slice(),("top-right"==this.offsetOrigin_||"bottom-right"==this.offsetOrigin_)&&(e[0]=i[0]-t[0]-e[0]),("bottom-left"==this.offsetOrigin_||"bottom-right"==this.offsetOrigin_)&&(e[1]=i[1]-t[1]-e[1]);}return this.origin_=e,this.origin_;}getSrc(){return this.iconImage_.getSrc();}getSize(){return this.size_?this.size_:this.iconImage_.getSize();}getWidth(){let e=this.getScaleArray();return this.size_?this.size_[0]*e[0]:this.iconImage_.getImageState()==tS.default.LOADED?this.iconImage_.getSize()[0]*e[0]:void 0;}getHeight(){let e=this.getScaleArray();return this.size_?this.size_[1]*e[1]:this.iconImage_.getImageState()==tS.default.LOADED?this.iconImage_.getSize()[1]*e[1]:void 0;}setScale(e){delete this.initialOptions_,super.setScale(e);}listenImageChange(e){this.iconImage_.addEventListener(S.default.CHANGE,e);}load(){this.iconImage_.load();}unlistenImageChange(e){this.iconImage_.removeEventListener(S.default.CHANGE,e);}ready(){return this.iconImage_.ready();}}class tU{constructor(e){e=e||{},this.color_=void 0!==e.color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width;}clone(){let e=this.getColor();return new tU({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()});}getColor(){return this.color_;}getLineCap(){return this.lineCap_;}getLineDash(){return this.lineDash_;}getLineDashOffset(){return this.lineDashOffset_;}getLineJoin(){return this.lineJoin_;}getMiterLimit(){return this.miterLimit_;}getWidth(){return this.width_;}setColor(e){this.color_=e;}setLineCap(e){this.lineCap_=e;}setLineDash(e){this.lineDash_=e;}setLineDashOffset(e){this.lineDashOffset_=e;}setLineJoin(e){this.lineJoin_=e;}setMiterLimit(e){this.miterLimit_=e;}setWidth(e){this.width_=e;}}class tV{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=tX,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.hitDetectionRenderer_=void 0!==e.hitDetectionRenderer?e.hitDetectionRenderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex;}clone(){let e=this.getGeometry();return e&&"object"==typeof e&&(e=e.clone()),new tV({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()});}getRenderer(){return this.renderer_;}setRenderer(e){this.renderer_=e;}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e;}getHitDetectionRenderer(){return this.hitDetectionRenderer_;}getGeometry(){return this.geometry_;}getGeometryFunction(){return this.geometryFunction_;}getFill(){return this.fill_;}setFill(e){this.fill_=e;}getImage(){return this.image_;}setImage(e){this.image_=e;}getStroke(){return this.stroke_;}setStroke(e){this.stroke_=e;}getText(){return this.text_;}setText(e){this.text_=e;}getZIndex(){return this.zIndex_;}setGeometry(e){"function"==typeof e?this.geometryFunction_=e:"string"==typeof e?this.geometryFunction_=function(t){return t.get(e);}:e?void 0!==e&&(this.geometryFunction_=function(){return e;}):this.geometryFunction_=tX,this.geometry_=e;}setZIndex(e){this.zIndex_=e;}}let tj=null;function tW(e,t){if(!tj){let e=new tK({color:"rgba(255,255,255,0.4)"}),t=new tU({color:"#3399CC",width:1.25});tj=[new tV({image:new tz({fill:e,stroke:t,radius:5}),fill:e,stroke:t})];}return tj;}function tX(e){return e.getGeometry();}class tH{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=(0,e8.toSize)(void 0!==e.scale?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=void 0!==e.fill?e.fill:new tK({color:"#333"}),this.maxAngle_=void 0!==e.maxAngle?e.maxAngle:Math.PI/4,this.placement_=void 0!==e.placement?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=void 0!==e.stroke?e.stroke:null,this.offsetX_=void 0!==e.offsetX?e.offsetX:0,this.offsetY_=void 0!==e.offsetY?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=void 0===e.padding?null:e.padding,this.declutterMode_=e.declutterMode;}clone(){let e=this.getScale();return new tH({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()});}getOverflow(){return this.overflow_;}getFont(){return this.font_;}getMaxAngle(){return this.maxAngle_;}getPlacement(){return this.placement_;}getRepeat(){return this.repeat_;}getOffsetX(){return this.offsetX_;}getOffsetY(){return this.offsetY_;}getFill(){return this.fill_;}getRotateWithView(){return this.rotateWithView_;}getKeepUpright(){return this.keepUpright_;}getRotation(){return this.rotation_;}getScale(){return this.scale_;}getScaleArray(){return this.scaleArray_;}getStroke(){return this.stroke_;}getText(){return this.text_;}getTextAlign(){return this.textAlign_;}getJustify(){return this.justify_;}getTextBaseline(){return this.textBaseline_;}getBackgroundFill(){return this.backgroundFill_;}getBackgroundStroke(){return this.backgroundStroke_;}getPadding(){return this.padding_;}getDeclutterMode(){return this.declutterMode_;}setOverflow(e){this.overflow_=e;}setFont(e){this.font_=e;}setMaxAngle(e){this.maxAngle_=e;}setOffsetX(e){this.offsetX_=e;}setOffsetY(e){this.offsetY_=e;}setPlacement(e){this.placement_=e;}setRepeat(e){this.repeat_=e;}setRotateWithView(e){this.rotateWithView_=e;}setKeepUpright(e){this.keepUpright_=e;}setFill(e){this.fill_=e;}setRotation(e){this.rotation_=e;}setScale(e){this.scale_=e,this.scaleArray_=(0,e8.toSize)(void 0!==e?e:1);}setStroke(e){this.stroke_=e;}setText(e){this.text_=e;}setTextAlign(e){this.textAlign_=e;}setJustify(e){this.justify_=e;}setTextBaseline(e){this.textBaseline_=e;}setBackgroundFill(e){this.backgroundFill_=e;}setBackgroundStroke(e){this.backgroundStroke_=e;}setPadding(e){this.padding_=e;}}function tq(e){return!0;}function tY(e){let t=tu(),i=e.length,r=Array(i);for(let n=0;n<i;++n)r[n]=t$(e[n],t);let n=tb(),s=Array(i);return function(e,o){if(n.properties=e.getPropertiesInternal(),n.resolution=o,t.featureId){let t=e.getId();void 0!==t?n.featureId=t:n.featureId=null;}let a=0;for(let e=0;e<i;++e){let t=r[e](n);t&&(s[a]=t,a+=1);}return s.length=a,s;};}function t$(e,t){let i=tZ(e,"",t),r=tJ(e,"",t),n=function(e,t){let i="text-",r=t0(e,i+"value",t);if(!r)return null;let n=tZ(e,i,t),s=tZ(e,i+"background-",t),o=tJ(e,i,t),a=tJ(e,i+"background-",t),l=t0(e,i+"font",t),h=tQ(e,i+"max-angle",t),d=tQ(e,i+"offset-x",t),u=tQ(e,i+"offset-y",t),c=t1(e,i+"overflow",t),g=t0(e,i+"placement",t),p=tQ(e,i+"repeat",t),_=t4(e,i+"scale",t),f=t1(e,i+"rotate-with-view",t),m=tQ(e,i+"rotation",t),y=t0(e,i+"align",t),v=t0(e,i+"justify",t),E=t0(e,i+"baseline",t),x=t1(e,i+"keep-upright",t),w=t3(e,i+"padding",t),b=new tH({declutterMode:ie(e,i+"declutter-mode")});return function(e){if(b.setText(r(e)),n&&b.setFill(n(e)),s&&b.setBackgroundFill(s(e)),o&&b.setStroke(o(e)),a&&b.setBackgroundStroke(a(e)),l&&b.setFont(l(e)),h&&b.setMaxAngle(h(e)),d&&b.setOffsetX(d(e)),u&&b.setOffsetY(u(e)),c&&b.setOverflow(c(e)),g){let t=g(e);if("point"!==t&&"line"!==t)throw Error("Expected point or line for text-placement");b.setPlacement(t);}if(p&&b.setRepeat(p(e)),_&&b.setScale(_(e)),f&&b.setRotateWithView(f(e)),m&&b.setRotation(m(e)),y){let t=y(e);if("left"!==t&&"center"!==t&&"right"!==t&&"end"!==t&&"start"!==t)throw Error("Expected left, right, center, start, or end for text-align");b.setTextAlign(t);}if(v){let t=v(e);if("left"!==t&&"right"!==t&&"center"!==t)throw Error("Expected left, right, or center for text-justify");b.setJustify(t);}if(E){let t=E(e);if("bottom"!==t&&"top"!==t&&"middle"!==t&&"alphabetic"!==t&&"hanging"!==t)throw Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");b.setTextBaseline(t);}return w&&b.setPadding(w(e)),x&&b.setKeepUpright(x(e)),b;};}(e,t),s="icon-src"in e?function(e,t){let i="icon-",r=i+"src",n=ii(e[r],r),s=t5(e,i+"anchor",t),o=t4(e,i+"scale",t),a=tQ(e,i+"opacity",t),l=t5(e,i+"displacement",t),h=tQ(e,i+"rotation",t),d=t1(e,i+"rotate-with-view",t),u=t7(e,i+"anchor-origin"),c=t9(e,i+"anchor-x-units"),g=t9(e,i+"anchor-y-units"),p=function(e,t){let i=e[t];if(void 0!==i)return is(i,t);}(e,i+"color"),_=function(e,t){let i=e[t];if(void 0!==i){if("string"!=typeof i)throw Error(`Expected a string for ${t}`);return i;}}(e,i+"cross-origin"),f=function(e,t){let i=e[t];if(void 0!==i)return it(i,t);}(e,i+"offset"),m=t7(e,i+"offset-origin"),y=t8(e,i+"width"),v=new tG({src:n,anchorOrigin:u,anchorXUnits:c,anchorYUnits:g,color:p,crossOrigin:_,offset:f,offsetOrigin:m,height:t8(e,i+"height"),width:y,size:function(e,t){let i=e[t];if(void 0!==i){if("number"==typeof i)return(0,e8.toSize)(i);if(!Array.isArray(i)||2!==i.length||"number"!=typeof i[0]||"number"!=typeof i[1])throw Error(`Expected a number or size array for ${t}`);return i;}}(e,i+"size"),declutterMode:ie(e,i+"declutter-mode")});return function(e){return a&&v.setOpacity(a(e)),l&&v.setDisplacement(l(e)),h&&v.setRotation(h(e)),d&&v.setRotateWithView(d(e)),o&&v.setScale(o(e)),s&&v.setAnchor(s(e)),v;};}(e,t):"shape-points"in e?function(e,t){let i="shape-",r=i+"points",n=i+"radius",s=ir(e[r],r),o=ir(e[n],n),a=tZ(e,i,t),l=tJ(e,i,t),h=t4(e,i+"scale",t),d=t5(e,i+"displacement",t),u=tQ(e,i+"rotation",t),c=t1(e,i+"rotate-with-view",t),g=new tN({points:s,radius:o,radius2:t8(e,i+"radius2"),angle:t8(e,i+"angle"),declutterMode:ie(e,i+"declutter-mode")});return function(e){return a&&g.setFill(a(e)),l&&g.setStroke(l(e)),d&&g.setDisplacement(d(e)),u&&g.setRotation(u(e)),c&&g.setRotateWithView(c(e)),h&&g.setScale(h(e)),g;};}(e,t):"circle-radius"in e?function(e,t){let i="circle-",r=tZ(e,i,t),n=tJ(e,i,t),s=tQ(e,i+"radius",t),o=t4(e,i+"scale",t),a=t5(e,i+"displacement",t),l=tQ(e,i+"rotation",t),h=t1(e,i+"rotate-with-view",t),d=new tz({radius:5,declutterMode:ie(e,i+"declutter-mode")});return function(e){return s&&d.setRadius(s(e)),r&&d.setFill(r(e)),n&&d.setStroke(n(e)),a&&d.setDisplacement(a(e)),l&&d.setRotation(l(e)),h&&d.setRotateWithView(h(e)),o&&d.setScale(o(e)),d;};}(e,t):null,o=tQ(e,"z-index",t);if(!i&&!r&&!n&&!s&&!(0,U.isEmpty)(e))throw Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(e));let a=new tV;return function(e){let t=!0;if(i){let r=i(e);r&&(t=!1),a.setFill(r);}if(r){let i=r(e);i&&(t=!1),a.setStroke(i);}if(n){let i=n(e);i&&(t=!1),a.setText(i);}if(s){let i=s(e);i&&(t=!1),a.setImage(i);}return(o&&a.setZIndex(o(e)),t)?null:a;};}function tZ(e,t,i){let r;if(t+"fill-pattern-src" in e)r=function(e,t,i){let r=t0(e,t+"pattern-src",i),n=t6(e,t+"pattern-offset",i),s=t6(e,t+"pattern-size",i),o=t2(e,t+"color",i);return function(e){return{src:r(e),offset:n&&n(e),size:s&&s(e),color:o&&o(e)};};}(e,t+"fill-",i);else{if("none"===e[t+"fill-color"])return e=>null;r=t2(e,t+"fill-color",i);}if(!r)return null;let n=new tK;return function(e){let t=r(e);return t===e4.NO_COLOR?null:(n.setColor(t),n);};}function tJ(e,t,i){let r=tQ(e,t+"stroke-width",i),n=t2(e,t+"stroke-color",i);if(!r&&!n)return null;let s=t0(e,t+"stroke-line-cap",i),o=t0(e,t+"stroke-line-join",i),a=t3(e,t+"stroke-line-dash",i),l=tQ(e,t+"stroke-line-dash-offset",i),h=tQ(e,t+"stroke-miter-limit",i),d=new tU;return function(e){if(n){let t=n(e);if(t===e4.NO_COLOR)return null;d.setColor(t);}if(r&&d.setWidth(r(e)),s){let t=s(e);if("butt"!==t&&"round"!==t&&"square"!==t)throw Error("Expected butt, round, or square line cap");d.setLineCap(t);}if(o){let t=o(e);if("bevel"!==t&&"round"!==t&&"miter"!==t)throw Error("Expected bevel, round, or miter line join");d.setLineJoin(t);}return a&&d.setLineDash(a(e)),l&&d.setLineDashOffset(l(e)),h&&d.setMiterLimit(h(e)),d;};}function tQ(e,t,i){if(!(t in e))return;let r=tC(e[t],te,i);return function(e){return ir(r(e),t);};}function t0(e,t,i){if(!(t in e))return null;let r=tC(e[t],tt,i);return function(e){return ii(r(e),t);};}function t1(e,t,i){if(!(t in e))return null;let r=tC(e[t],e9,i);return function(e){let i=r(e);if("boolean"!=typeof i)throw Error(`Expected a boolean for ${t}`);return i;};}function t2(e,t,i){if(!(t in e))return null;let r=tC(e[t],ti,i);return function(e){return is(r(e),t);};}function t3(e,t,i){if(!(t in e))return null;let r=tC(e[t],tr,i);return function(e){return it(r(e),t);};}function t5(e,t,i){if(!(t in e))return null;let r=tC(e[t],tr,i);return function(e){let i=it(r(e),t);if(2!==i.length)throw Error(`Expected two numbers for ${t}`);return i;};}function t6(e,t,i){if(!(t in e))return null;let r=tC(e[t],tr,i);return function(e){return io(r(e),t);};}function t4(e,t,i){if(!(t in e))return null;let r=tC(e[t],tr|te,i);return function(e){var i;return"number"==typeof(i=r(e))?i:io(i,t);};}function t8(e,t){let i=e[t];if(void 0!==i){if("number"!=typeof i)throw Error(`Expected a number for ${t}`);return i;}}function t7(e,t){let i=e[t];if(void 0!==i){if("bottom-left"!==i&&"bottom-right"!==i&&"top-left"!==i&&"top-right"!==i)throw Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${t}`);return i;}}function t9(e,t){let i=e[t];if(void 0!==i){if("pixels"!==i&&"fraction"!==i)throw Error(`Expected pixels or fraction for ${t}`);return i;}}function ie(e,t){let i=e[t];if(void 0!==i){if("string"!=typeof i)throw Error(`Expected a string for ${t}`);if("declutter"!==i&&"obstacle"!==i&&"none"!==i)throw Error(`Expected declutter, obstacle, or none for ${t}`);return i;}}function it(e,t){if(!Array.isArray(e))throw Error(`Expected an array for ${t}`);let i=e.length;for(let r=0;r<i;++r)if("number"!=typeof e[r])throw Error(`Expected an array of numbers for ${t}`);return e;}function ii(e,t){if("string"!=typeof e)throw Error(`Expected a string for ${t}`);return e;}function ir(e,t){if("number"!=typeof e)throw Error(`Expected a number for ${t}`);return e;}function is(e,t){if("string"==typeof e)return e;let i=it(e,t),r=i.length;if(r<3||r>4)throw Error(`Expected a color with 3 or 4 values for ${t}`);return i;}function io(e,t){let i=it(e,t);if(2!==i.length)throw Error(`Expected an array of two numbers for ${t}`);return i;}let ia="renderOrder";class il extends eV.default{constructor(e){let t=Object.assign({},e=e||{});delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=void 0!==e.renderBuffer?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=void 0!==e.updateWhileAnimating&&e.updateWhileAnimating,this.updateWhileInteracting_=void 0!==e.updateWhileInteracting&&e.updateWhileInteracting;}getDeclutter(){return this.declutter_;}getFeatures(e){return super.getFeatures(e);}getRenderBuffer(){return this.renderBuffer_;}getRenderOrder(){return this.get(ia);}getStyle(){return this.style_;}getStyleFunction(){return this.styleFunction_;}getUpdateWhileAnimating(){return this.updateWhileAnimating_;}getUpdateWhileInteracting(){return this.updateWhileInteracting_;}renderDeclutter(e,t){let i=this.getDeclutter();i in e.declutter==!1&&(e.declutter[i]=new eq(9)),this.getRenderer().renderDeclutter(e,t);}setRenderOrder(e){this.set(ia,e);}setStyle(e){this.style_=void 0===e?tW:e;let t=function(e){if(void 0===e)return tW;if(!e)return null;if("function"==typeof e||e instanceof tV)return e;if(!Array.isArray(e))return tY([e]);if(0===e.length)return[];let t=e.length,i=e[0];if(i instanceof tV){let i=Array(t);for(let r=0;r<t;++r){let t=e[r];if(!(t instanceof tV))throw Error("Expected a list of style instances");i[r]=t;}return i;}if("style"in i){let i=Array(t);for(let r=0;r<t;++r){let t=e[r];if(!("style"in t))throw Error("Expected a list of rules with a style property");i[r]=t;}return function(e){let t=tu(),i=function(e,t){let i=e.length,r=Array(i);for(let n=0;n<i;++n){let i;let s=e[n],o="filter"in s?tC(s.filter,e9,t):tq;if(Array.isArray(s.style)){let e=s.style.length;i=Array(e);for(let r=0;r<e;++r)i[r]=t$(s.style[r],t);}else i=[t$(s.style,t)];r[n]={filter:o,styles:i};}return function(t){let n=[],s=!1;for(let o=0;o<i;++o)if((0,r[o].filter)(t)&&(!e[o].else||!s))for(let e of(s=!0,r[o].styles)){let i=e(t);i&&n.push(i);}return n;};}(e,t),r=tb();return function(e,n){if(r.properties=e.getPropertiesInternal(),r.resolution=n,t.featureId){let t=e.getId();void 0!==t?r.featureId=t:r.featureId=null;}return t.geometryType&&(r.geometryType=function e(t){if(!t)return"";let i=t.getType();switch(i){case"Point":case"LineString":case"Polygon":return i;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return i.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return e(t.getGeometries()[0]);default:return"";}}(e.getGeometry())),i(r);};}(i);}return tY(e);}(e);this.styleFunction_=null===e?void 0:function(e){let t;if("function"==typeof e)t=e;else{let i;Array.isArray(e)?i=e:((0,G.assert)("function"==typeof e.getZIndex,"Expected an `Style` or an array of `Style`"),i=[e]),t=function(){return i;};}return t;}(t),this.changed();}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed();}}var ih=i("8133f8a8"),id=r._(ih),iu=i("870b3da6");class ic extends ex.default{constructor(e){super(),this.map_=e;}dispatchRenderEvent(e,t){(0,eF.abstract)();}calculateMatrices2D(e){let t=e.viewState,i=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;(0,iu.compose)(i,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),(0,iu.makeInverse)(r,i);}forEachFeatureAtCoordinate(e,t,i,r,n,s,o,a){let l;let h=t.viewState;function d(e,t,i,r){return n.call(s,t,e?i:null,r);}let u=h.projection,c=(0,eg.wrapX)(e.slice(),u),g=[[0,0]];if(u.canWrapX()&&r){let e=u.getExtent(),t=(0,el.getWidth)(e);g.push([-t,0],[t,0]);}let p=t.layerStatesArray,_=p.length,f=[],m=[];for(let r=0;r<g.length;r++)for(let n=_-1;n>=0;--n){let s=p[n],u=s.layer;if(u.hasRenderer()&&(0,eV.inView)(s,h)&&o.call(a,u)){let n=u.getRenderer(),o=u.getSource();if(n&&o){let a=o.getWrapX()?c:e,h=d.bind(null,s.managed);m[0]=a[0]+g[r][0],m[1]=a[1]+g[r][1],l=n.forEachFeatureAtCoordinate(m,t,i,h,f);}if(l)return l;}}if(0===f.length)return;let y=1/f.length;return f.forEach((e,t)=>e.distanceSq+=t*y),f.sort((e,t)=>e.distanceSq-t.distanceSq),f.some(e=>l=e.callback(e.feature,e.layer,e.geometry)),l;}hasFeatureAtCoordinate(e,t,i,r,n,s){return void 0!==this.forEachFeatureAtCoordinate(e,t,i,r,ee.TRUE,this,n,s);}getMap(){return this.map_;}renderFrame(e){(0,eF.abstract)();}scheduleExpireIconCache(e){tI.shared.canExpireCache()&&e.postRenderFunctions.push(ig);}}function ig(e,t){tI.shared.expire();}class ip extends ic{constructor(e){super(e),this.fontChangeListenerKey_=(0,I.listen)(tk,z.default.PROPERTYCHANGE,e.redrawText,e),this.element_=document.createElement("div");let t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=J.CLASS_UNSELECTABLE+" ol-layers";let i=e.getViewport();i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0;}dispatchRenderEvent(e,t){let i=this.getMap();if(i.hasListener(e)){let r=new id.default(e,void 0,t);i.dispatchEvent(r);}}disposeInternal(){(0,I.unlistenByKey)(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal();}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return;}this.calculateMatrices2D(e),this.dispatchRenderEvent(eX.default.PRECOMPOSE,e);let t=e.layerStatesArray.sort((e,t)=>e.zIndex-t.zIndex);t.some(e=>e.layer instanceof il&&e.layer.getDeclutter())&&(e.declutter={});let i=e.viewState;this.children_.length=0;let r=[],n=null;for(let s=0,o=t.length;s<o;++s){let o=t[s];e.layerIndex=s;let a=o.layer,l=a.getSourceState();if(!(0,eV.inView)(o,i)||"ready"!=l&&"undefined"!=l){a.unrender();continue;}let h=a.render(e,n);h&&(h!==n&&(this.children_.push(h),n=h),r.push(o));}this.declutter(e,r),(0,Q.replaceChildren)(this.element_,this.children_),this.dispatchRenderEvent(eX.default.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e);}declutter(e,t){if(e.declutter){for(let i=t.length-1;i>=0;--i){let r=t[i],n=r.layer;n.getDeclutter()&&n.renderDeclutter(e,r);}t.forEach(t=>t.layer.renderDeferred(e));}}}class i_ extends f.default{constructor(e){super(),e=e||{},this.on,this.once,this.un;let t=function(e){let t,i,r,n=null;void 0!==e.keyboardEventTarget&&(n="string"==typeof e.keyboardEventTarget?document.getElementById(e.keyboardEventTarget):e.keyboardEventTarget);let s={},o=e.layers&&"function"==typeof e.layers.getLayers?e.layers:new eG({layers:e.layers});return s[F.LAYERGROUP]=o,s[F.TARGET]=e.target,s[F.VIEW]=e.view instanceof H.default?e.view:new H.default,void 0!==e.controls&&(Array.isArray(e.controls)?t=new x(e.controls.slice()):((0,G.assert)("function"==typeof e.controls.getArray,"Expected `controls` to be an array or an `ol/Collection.js`"),t=e.controls)),void 0!==e.interactions&&(Array.isArray(e.interactions)?i=new x(e.interactions.slice()):((0,G.assert)("function"==typeof e.interactions.getArray,"Expected `interactions` to be an array or an `ol/Collection.js`"),i=e.interactions)),void 0!==e.overlays?Array.isArray(e.overlays)?r=new x(e.overlays.slice()):((0,G.assert)("function"==typeof e.overlays.getArray,"Expected `overlays` to be an array or an `ol/Collection.js`"),r=e.overlays):r=new x,{controls:t,interactions:i,keyboardEventTarget:n,overlays:r,values:s};}(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=void 0!==e.maxTilesLoading?e.maxTilesLoading:16,this.pixelRatio_=void 0!==e.pixelRatio?e.pixelRatio:D.DEVICE_PIXEL_RATIO,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=(0,iu.create)(),this.pixelToCoordinateTransform_=(0,iu.create)(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=t.controls||ea(),this.interactions=t.interactions||function(e){e=e||{};let t=new x,i=new eh(-.005,.05,100);return(void 0===e.altShiftDragRotate||e.altShiftDragRotate)&&t.push(new ev),(void 0===e.doubleClickZoom||e.doubleClickZoom)&&t.push(new ec({delta:e.zoomDelta,duration:e.zoomDuration})),(void 0===e.dragPan||e.dragPan)&&t.push(new em({onFocusOnly:e.onFocusOnly,kinetic:i})),(void 0===e.pinchRotate||e.pinchRotate)&&t.push(new eM),(void 0===e.pinchZoom||e.pinchZoom)&&t.push(new ek({duration:e.zoomDuration})),(void 0===e.keyboard||e.keyboard)&&(t.push(new eI),t.push(new eD({delta:e.zoomDelta,duration:e.zoomDuration}))),(void 0===e.mouseWheelZoom||e.mouseWheelZoom)&&t.push(new eP({onFocusOnly:e.onFocusOnly,duration:e.zoomDuration})),(void 0===e.shiftDragZoom||e.shiftDragZoom)&&t.push(new eA({duration:e.zoomDuration})),t;}({onFocusOnly:!0}),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new W(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(F.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(F.VIEW,this.handleViewChanged_),this.addChangeListener(F.SIZE,this.handleSizeChanged_),this.addChangeListener(F.TARGET,this.handleTargetChanged_),this.setProperties(t.values);let i=this;!e.view||e.view instanceof H.default||e.view.then(function(e){i.setView(new H.default(e));}),this.controls.addEventListener(p.ADD,e=>{e.element.setMap(this);}),this.controls.addEventListener(p.REMOVE,e=>{e.element.setMap(null);}),this.interactions.addEventListener(p.ADD,e=>{e.element.setMap(this);}),this.interactions.addEventListener(p.REMOVE,e=>{e.element.setMap(null);}),this.overlays_.addEventListener(p.ADD,e=>{this.addOverlayInternal_(e.element);}),this.overlays_.addEventListener(p.REMOVE,e=>{let t=e.element.getId();void 0!==t&&delete this.overlayIdIndex_[t.toString()],e.element.setMap(null);}),this.controls.forEach(e=>{e.setMap(this);}),this.interactions.forEach(e=>{e.setMap(this);}),this.overlays_.forEach(this.addOverlayInternal_.bind(this));}addControl(e){this.getControls().push(e);}addInteraction(e){this.getInteractions().push(e);}addLayer(e){this.getLayerGroup().getLayers().push(e);}handleLayerAdd_(e){!function e(t,i){if(t instanceof eV.default){t.setMapInternal(i);return;}if(t instanceof eG){let r=t.getLayers().getArray();for(let t=0,n=r.length;t<n;++t)e(r[t],i);}}(e.layer,this);}addOverlay(e){this.getOverlays().push(e);}addOverlayInternal_(e){let t=e.getId();void 0!==t&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this);}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal();}forEachFeatureAtPixel(e,t,i){if(!this.frameState_||!this.renderer_)return;let r=this.getCoordinateFromPixelInternal(e),n=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance:0,s=void 0!==i.layerFilter?i.layerFilter:ee.TRUE,o=!1!==i.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,n,o,t,null,s,null);}getFeaturesAtPixel(e,t){let i=[];return this.forEachFeatureAtPixel(e,function(e){i.push(e);},t),i;}getAllLayers(){let e=[];return!function t(i){i.forEach(function(i){i instanceof eG?t(i.getLayers()):e.push(i);});}(this.getLayers()),e;}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;let i=this.getCoordinateFromPixelInternal(e),r=void 0!==(t=void 0!==t?t:{}).layerFilter?t.layerFilter:ee.TRUE,n=void 0!==t.hitTolerance?t.hitTolerance:0,s=!1!==t.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,n,s,r,null);}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e));}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e));}getEventPixel(e){let t=this.viewport_.getBoundingClientRect(),i=this.getSize(),r=t.width/i[0],n=t.height/i[1],s="changedTouches"in e?e.changedTouches[0]:e;return[(s.clientX-t.left)/r,(s.clientY-t.top)/n];}getTarget(){return this.get(F.TARGET);}getTargetElement(){return this.targetElement_;}getCoordinateFromPixel(e){return(0,ej.toUserCoordinate)(this.getCoordinateFromPixelInternal(e),this.getView().getProjection());}getCoordinateFromPixelInternal(e){let t=this.frameState_;return t?(0,iu.apply)(t.pixelToCoordinateTransform,e.slice()):null;}getControls(){return this.controls;}getOverlays(){return this.overlays_;}getOverlayById(e){let t=this.overlayIdIndex_[e.toString()];return void 0!==t?t:null;}getInteractions(){return this.interactions;}getLayerGroup(){return this.get(F.LAYERGROUP);}setLayers(e){let t=this.getLayerGroup();if(e instanceof x){t.setLayers(e);return;}let i=t.getLayers();i.clear(),i.extend(e);}getLayers(){return this.getLayerGroup().getLayers();}getLoadingOrNotReady(){let e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){let i=e[t];if(!i.visible)continue;let r=i.layer.getRenderer();if(r&&!r.ready)return!0;let n=i.layer.getSource();if(n&&n.loading)return!0;}return!1;}getPixelFromCoordinate(e){let t=(0,ej.fromUserCoordinate)(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t);}getPixelFromCoordinateInternal(e){let t=this.frameState_;return t?(0,iu.apply)(t.coordinateToPixelTransform,e.slice(0,2)):null;}getRenderer(){return this.renderer_;}getSize(){return this.get(F.SIZE);}getView(){return this.get(F.VIEW);}getViewport(){return this.viewport_;}getOverlayContainer(){return this.overlayContainer_;}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_;}getOwnerDocument(){let e=this.getTargetElement();return e?e.ownerDocument:document;}getTilePriority(e,t,i,r){return function(e,t,i,r,n){if(!e||!(i in e.wantedTiles)||!e.wantedTiles[i][t.getKey()])return V;let s=e.viewState.center,o=r[0]-s[0],a=r[1]-s[1];return 65536*Math.log(n)+Math.sqrt(o*o+a*a)/n;}(this.frameState_,e,t,i,r);}handleBrowserEvent(e,t){let i=new b(t=t||e.type,this,e);this.handleMapBrowserEvent(i);}handleMapBrowserEvent(e){if(!this.frameState_)return;let t=e.originalEvent,i=t.type;if(i===O.POINTERDOWN||i===S.default.WHEEL||i===S.default.KEYDOWN){let e=this.getOwnerDocument(),i=this.viewport_.getRootNode?this.viewport_.getRootNode():e,r=t.target,n=i instanceof ShadowRoot?i.host===r?i.host.ownerDocument:i:i===e?e.documentElement:i;if(this.overlayContainerStopEvent_.contains(r)||!n.contains(r))return;}if(e.frameState=this.frameState_,!1!==this.dispatchEvent(e)){let t=this.getInteractions().getArray().slice();for(let i=t.length-1;i>=0;i--){let r=t[i];if(r.getMap()===this&&r.getActive()&&this.getTargetElement()&&(!r.handleEvent(e)||e.propagationStopped))break;}}}handlePostRender(){let e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let i=this.maxTilesLoading_,r=i;if(e){let t=e.viewHints;if(t[Y.default.ANIMATING]||t[Y.default.INTERACTING]){let t=Date.now()-e.time>8;i=t?0:8,r=t?0:2;}}t.getTilesLoading()<i&&(t.reprioritize(),t.loadMoreTiles(i,r));}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(eX.default.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(eX.default.RENDERCOMPLETE,e),!1===this.loaded_&&(this.loaded_=!0,this.dispatchEvent(new w(k.default.LOADEND,this,e)))):!0===this.loaded_&&(this.loaded_=!1,this.dispatchEvent(new w(k.default.LOADSTART,this,e))));let i=this.postRenderFunctions_;if(e)for(let t=0,r=i.length;t<r;++t)i[t](this,e);i.length=0;}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render();}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let e=0,t=this.targetChangeHandlerKeys_.length;e<t;++e)(0,I.unlistenByKey)(this.targetChangeHandlerKeys_[e]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(S.default.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(S.default.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove();}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);let e=this.targetElement_.getRootNode();e instanceof ShadowRoot&&this.resizeObserver_.unobserve(e.host),this.setSize(void 0);}let e=this.getTarget(),t="string"==typeof e?document.getElementById(e):e;if(this.targetElement_=t,t){let e;for(let e in t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new ip(this)),this.mapBrowserEventHandler_=new P(this,this.moveTolerance_),T.default)this.mapBrowserEventHandler_.addEventListener(T.default[e],this.handleMapBrowserEvent.bind(this));if(this.viewport_.addEventListener(S.default.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(S.default.WHEEL,this.boundHandleBrowserEvent_,!!D.PASSIVE_EVENT_LISTENERS&&{passive:!1}),this.keyboardEventTarget_)e=this.keyboardEventTarget_;else{let i=t.getRootNode();e=i instanceof ShadowRoot?i.host:t;}this.targetChangeHandlerKeys_=[(0,I.listen)(e,S.default.KEYDOWN,this.handleBrowserEvent,this),(0,I.listen)(e,S.default.KEYPRESS,this.handleBrowserEvent,this)];let i=t.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.observe(i.host),this.resizeObserver_.observe(t);}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize();}handleTileChange_(){this.render();}handleViewPropertyChanged_(){this.render();}handleViewChanged_(){this.viewPropertyListenerKey_&&((0,I.unlistenByKey)(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&((0,I.unlistenByKey)(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);let e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=(0,I.listen)(e,z.default.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=(0,I.listen)(e,S.default.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render();}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(I.unlistenByKey),this.layerGroupPropertyListenerKeys_=null);let e=this.getLayerGroup();e&&(this.handleLayerAdd_(new eK("addlayer",e)),this.layerGroupPropertyListenerKeys_=[(0,I.listen)(e,z.default.PROPERTYCHANGE,this.render,this),(0,I.listen)(e,S.default.CHANGE,this.render,this),(0,I.listen)(e,"addlayer",this.handleLayerAdd_,this),(0,I.listen)(e,"removelayer",this.handleLayerRemove_,this)]),this.render();}isRendered(){return!!this.frameState_;}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now());}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_();}redrawText(){let e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){let i=e[t].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged();}}render(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_));}removeControl(e){return this.getControls().remove(e);}removeInteraction(e){return this.getInteractions().remove(e);}removeLayer(e){return this.getLayerGroup().getLayers().remove(e);}handleLayerRemove_(e){!function e(t){if(t instanceof eV.default){t.setMapInternal(null);return;}t instanceof eG&&t.getLayers().forEach(e);}(e.layer);}removeOverlay(e){return this.getOverlays().remove(e);}renderFrame_(e){let t=this.getSize(),i=this.getView(),r=this.frameState_,n=null;if(void 0!==t&&(0,e8.hasArea)(t)&&i&&i.isDef()){let r=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),s=i.getState();if(n={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:(0,el.getForViewAndSize)(s.center,s.resolution,s.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:s,viewHints:r,wantedTiles:{},mapId:(0,eF.getUid)(this),renderTargets:{}},s.nextCenter&&s.nextResolution){let e=isNaN(s.nextRotation)?s.rotation:s.nextRotation;n.nextExtent=(0,el.getForViewAndSize)(s.nextCenter,s.nextResolution,e,t);}}this.frameState_=n,this.renderer_.renderFrame(n),!n||(n.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,n.postRenderFunctions),!r||this.previousExtent_&&((0,el.isEmpty)(this.previousExtent_)||(0,el.equals)(n.extent,this.previousExtent_))||(this.dispatchEvent(new w(k.default.MOVESTART,this,r)),this.previousExtent_=(0,el.createOrUpdateEmpty)(this.previousExtent_)),!this.previousExtent_||n.viewHints[Y.default.ANIMATING]||n.viewHints[Y.default.INTERACTING]||(0,el.equals)(n.extent,this.previousExtent_)||(this.dispatchEvent(new w(k.default.MOVEEND,this,n)),(0,el.clone)(n.extent,this.previousExtent_))),this.dispatchEvent(new w(k.default.POSTRENDER,this,n)),this.renderComplete_=(this.hasListener(k.default.LOADSTART)||this.hasListener(k.default.LOADEND)||this.hasListener(eX.default.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender();},0));}setLayerGroup(e){let t=this.getLayerGroup();t&&this.handleLayerRemove_(new eK("removelayer",t)),this.set(F.LAYERGROUP,e);}setSize(e){this.set(F.SIZE,e);}setTarget(e){this.set(F.TARGET,e);}setView(e){if(!e||e instanceof H.default){this.set(F.VIEW,e);return;}this.set(F.VIEW,new H.default);let t=this;e.then(function(e){t.setView(new H.default(e));});}updateSize(){let e;let t=this.getTargetElement();if(t){let i=getComputedStyle(t),r=t.offsetWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.paddingLeft)-parseFloat(i.paddingRight)-parseFloat(i.borderRightWidth),n=t.offsetHeight-parseFloat(i.borderTopWidth)-parseFloat(i.paddingTop)-parseFloat(i.paddingBottom)-parseFloat(i.borderBottomWidth);!isNaN(r)&&!isNaN(n)&&(e=[Math.max(0,r),Math.max(0,n)],!(0,e8.hasArea)(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&(0,Z.warn)("No map visible because the map container's width or height are 0."));}let i=this.getSize();!e||i&&(0,$.equals)(e,i)||(this.setSize(e),this.updateViewportSize_(e));}updateViewportSize_(e){let t=this.getView();t&&t.setViewportSize(e);}}let im=["fullscreenchange","webkitfullscreenchange"],iy={ENTERFULLSCREEN:"enterfullscreen",LEAVEFULLSCREEN:"leavefullscreen"};class iv extends ei.default{constructor(e){super({element:document.createElement("div"),target:(e=e||{}).target}),this.on,this.once,this.un,this.keys_=void 0!==e.keys&&e.keys,this.source_=e.source,this.isInFullscreen_=!1,this.boundHandleMapTargetChange_=this.handleMapTargetChange_.bind(this),this.cssClassName_=void 0!==e.className?e.className:"ol-full-screen",this.documentListeners_=[],this.activeClassName_=void 0!==e.activeClassName?e.activeClassName.split(" "):[this.cssClassName_+"-true"],this.inactiveClassName_=void 0!==e.inactiveClassName?e.inactiveClassName.split(" "):[this.cssClassName_+"-false"];let t=void 0!==e.label?e.label:"\u2922";this.labelNode_="string"==typeof t?document.createTextNode(t):t;let i=void 0!==e.labelActive?e.labelActive:"\xd7";this.labelActiveNode_="string"==typeof i?document.createTextNode(i):i;let r=e.tipLabel?e.tipLabel:"Toggle full-screen";this.button_=document.createElement("button"),this.button_.title=r,this.button_.setAttribute("type","button"),this.button_.appendChild(this.labelNode_),this.button_.addEventListener(S.default.CLICK,this.handleClick_.bind(this),!1),this.setClassName_(this.button_,this.isInFullscreen_),this.element.className=`${this.cssClassName_} ${J.CLASS_UNSELECTABLE} ${J.CLASS_CONTROL}`,this.element.appendChild(this.button_);}handleClick_(e){e.preventDefault(),this.handleFullScreen_();}handleFullScreen_(){let e=this.getMap();if(!e)return;let t=e.getOwnerDocument();if(iE(t)){if(ix(t))t.exitFullscreen?t.exitFullscreen():t.webkitExitFullscreen&&t.webkitExitFullscreen();else{let i;i=this.source_?"string"==typeof this.source_?t.getElementById(this.source_):this.source_:e.getTargetElement(),this.keys_&&i.webkitRequestFullscreen?i.webkitRequestFullscreen():iw(i);}}}handleFullScreenChange_(){let e=this.getMap();if(!e)return;let t=this.isInFullscreen_;this.isInFullscreen_=ix(e.getOwnerDocument()),t!==this.isInFullscreen_&&(this.setClassName_(this.button_,this.isInFullscreen_),this.isInFullscreen_?((0,Q.replaceNode)(this.labelActiveNode_,this.labelNode_),this.dispatchEvent(iy.ENTERFULLSCREEN)):((0,Q.replaceNode)(this.labelNode_,this.labelActiveNode_),this.dispatchEvent(iy.LEAVEFULLSCREEN)),e.updateSize());}setClassName_(e,t){t?(e.classList.remove(...this.inactiveClassName_),e.classList.add(...this.activeClassName_)):(e.classList.remove(...this.activeClassName_),e.classList.add(...this.inactiveClassName_));}setMap(e){let t=this.getMap();t&&t.removeChangeListener(F.TARGET,this.boundHandleMapTargetChange_),super.setMap(e),this.handleMapTargetChange_(),e&&e.addChangeListener(F.TARGET,this.boundHandleMapTargetChange_);}handleMapTargetChange_(){let e=this.documentListeners_;for(let t=0,i=e.length;t<i;++t)(0,I.unlistenByKey)(e[t]);e.length=0;let t=this.getMap();if(t){let i=t.getOwnerDocument();iE(i)?this.element.classList.remove(J.CLASS_UNSUPPORTED):this.element.classList.add(J.CLASS_UNSUPPORTED);for(let t=0,r=im.length;t<r;++t)e.push((0,I.listen)(i,im[t],this.handleFullScreenChange_,this));this.handleFullScreenChange_();}}}function iE(e){let t=e.body;return!!(t.webkitRequestFullscreen||t.requestFullscreen&&e.fullscreenEnabled);}function ix(e){return!!(e.webkitIsFullScreen||e.fullscreenElement);}function iw(e){e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen();}var ib=i("89333e33"),iC=r._(ib);function iT(e){return e instanceof Image||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageBitmap?e:null;}let iL=Error("disposed"),iS=[256,256];class iA extends iC.default{constructor(e){super(e.tileCoord,B.default.IDLE,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null;}getSize(){if(this.size_)return this.size_;let e=iT(this.data_);return e?[e.width,e.height]:iS;}getData(){return this.data_;}getError(){return this.error_;}load(){if(this.state!==B.default.IDLE&&this.state!==B.default.ERROR)return;this.state=B.default.LOADING,this.changed();let e=this;this.loader_().then(function(t){e.data_=t,e.state=B.default.LOADED,e.changed();}).catch(function(t){e.error_=t,e.state=B.default.ERROR,e.changed();});}disposeInternal(){this.controller_&&(this.controller_.abort(iL),this.controller_=null),super.disposeInternal();}}var iR=i("799e3201"),iI=r._(iR),iD=i("35b8a01f"),iO=r._(iD),iP=i("4c1ea786"),iM=r._(iP);class ik{constructor(e){this.highWaterMark=void 0!==e?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null;}deleteOldest(){let e=this.pop();e instanceof ex.default&&e.dispose();}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark;}expireCache(e){for(;this.canExpireCache();)this.deleteOldest();}clear(){for(;this.oldest_;)this.deleteOldest();}containsKey(e){return this.entries_.hasOwnProperty(e);}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer;}get(e,t){let i=this.entries_[e];return(0,G.assert)(void 0!==i,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_;}remove(e){let t=this.entries_[e];return(0,G.assert)(void 0!==t,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_;}getCount(){return this.count_;}getKeys(){let e;let t=Array(this.count_),i=0;for(e=this.newest_;e;e=e.older)t[i++]=e.key_;return t;}getValues(){let e;let t=Array(this.count_),i=0;for(e=this.newest_;e;e=e.older)t[i++]=e.value_;return t;}peekLast(){return this.oldest_.value_;}peekLastKey(){return this.oldest_.key_;}peekFirstKey(){return this.newest_.key_;}peek(e){var t;return null===(t=this.entries_[e])||void 0===t?void 0:t.value_;}pop(){let e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_;}replace(e,t){this.get(e),this.entries_[e].value_=t;}set(e,t){(0,G.assert)(!(e in this.entries_),"Tried to set a value for a key that is used already");let i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_;}setSize(e){this.highWaterMark=e;}}var iF=i("3e58d285");class iN{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy((0,Q.getSharedCanvasContext2D)(),{get:(e,t)=>{if("function"==typeof(0,Q.getSharedCanvasContext2D)()[t])return this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(t),this.pushMethodArgs_;},set:(e,t,i)=>(this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(t,i),!0)});}pushMethodArgs_=(...e)=>(this.instructions_[this.zIndex+this.offset_].push(e),this);pushFunction(e){this.instructions_[this.zIndex+this.offset_].push(e);}getContext(){return this.context_;}draw(e){this.instructions_.forEach(t=>{for(let i=0,r=t.length;i<r;++i){let r=t[i];if("function"==typeof r){r(e);continue;}let n=t[++i];if("function"==typeof e[r])e[r](...n);else{if("function"==typeof n){e[r]=n(e);continue;}e[r]=n;}}});}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0;}offset(){this.offset_=this.instructions_.length,this.zIndex=0;}}var iz=i("bc79d766"),iK=r._(iz);class iB extends iK.default{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=[],this.maxStaleKeys=5;}getStaleKeys(){return this.staleKeys_;}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys);}getFeatures(e){return(0,eF.abstract)();}getData(e){return null;}prepareFrame(e){return(0,eF.abstract)();}renderFrame(e,t){return(0,eF.abstract)();}forEachFeatureAtCoordinate(e,t,i,r,n){}getLayer(){return this.layer_;}handleFontsChanged(){}handleImageChange_(e){let t=e.target;(t.getState()===tS.default.LOADED||t.getState()===tS.default.ERROR)&&this.renderIfReadyAndVisible();}loadImage(e){let t=e.getState();return t!=tS.default.LOADED&&t!=tS.default.ERROR&&e.addEventListener(S.default.CHANGE,this.boundHandleImageChange_),t==tS.default.IDLE&&(e.load(),t=e.getState()),t==tS.default.LOADED;}renderIfReadyAndVisible(){let e=this.getLayer();e&&e.getVisible()&&"ready"===e.getSourceState()&&e.changed();}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal();}}let iG=null;class iU extends iB{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=(0,iu.create)(),this.pixelTransform=(0,iu.create)(),this.inversePixelTransform=(0,iu.create)(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null;}getImageData(e,t,i){let r;iG||(iG=(0,Q.createCanvasContext2D)(1,1,void 0,{willReadFrequently:!0})),iG.clearRect(0,0,1,1);try{iG.drawImage(e,t,i,1,1,0,0,1,1),r=iG.getImageData(0,0,1,1).data;}catch{return iG=null,null;}return r;}getBackground(e){let t=this.getLayer().getBackground();return"function"==typeof t&&(t=t(e.viewState.resolution)),t||void 0;}useContainer(e,t,i){let r,n;let s=this.getLayer().getClassName();if(e&&e.className===s&&(!i||e&&e.style.backgroundColor&&(0,$.equals)((0,e4.asArray)(e.style.backgroundColor),(0,e4.asArray)(i)))){let t=e.firstElementChild;t instanceof HTMLCanvasElement&&(n=t.getContext("2d"));}if(n&&n.canvas.style.transform===t?(this.container=e,this.context=n,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){(r=document.createElement("div")).className=s;let e=r.style;e.position="absolute",e.width="100%",e.height="100%";let t=(n=(0,Q.createCanvasContext2D)()).canvas;r.appendChild(t),(e=t.style).position="absolute",e.left="0",e.transformOrigin="top left",this.container=r,this.context=n;}this.containerReused||!i||this.container.style.backgroundColor||(this.container.style.backgroundColor=i);}clipUnrotated(e,t,i){let r=(0,el.getTopLeft)(i),n=(0,el.getTopRight)(i),s=(0,el.getBottomRight)(i),o=(0,el.getBottomLeft)(i);(0,iu.apply)(t.coordinateToPixelTransform,r),(0,iu.apply)(t.coordinateToPixelTransform,n),(0,iu.apply)(t.coordinateToPixelTransform,s),(0,iu.apply)(t.coordinateToPixelTransform,o);let a=this.inversePixelTransform;(0,iu.apply)(a,r),(0,iu.apply)(a,n),(0,iu.apply)(a,s),(0,iu.apply)(a,o),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(n[0]),Math.round(n[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.clip();}prepareContainer(e,t){let i=e.extent,r=e.viewState.resolution,n=e.viewState.rotation,s=e.pixelRatio,o=Math.round((0,el.getWidth)(i)/r*s),a=Math.round((0,el.getHeight)(i)/r*s);(0,iu.compose)(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/s,1/s,n,-o/2,-a/2),(0,iu.makeInverse)(this.inversePixelTransform,this.pixelTransform);let l=(0,iu.toString)(this.pixelTransform);if(this.useContainer(t,l,this.getBackground(e)),!this.containerReused){let e=this.context.canvas;e.width!=o||e.height!=a?(e.width=o,e.height=a):this.context.clearRect(0,0,o,a),l!==e.style.transform&&(e.style.transform=l);}}dispatchRenderEvent_(e,t,i){let r=this.getLayer();if(r.hasListener(e)){let n=new id.default(e,this.inversePixelTransform,i,t);r.dispatchEvent(n);}}preRender(e,t){this.frameState=t,t.declutter||this.dispatchRenderEvent_(eX.default.PRERENDER,e,t);}postRender(e,t){t.declutter||this.dispatchRenderEvent_(eX.default.POSTRENDER,e,t);}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new iN),e.declutter?this.deferredContext_.getContext():this.context;}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(eX.default.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(eX.default.POSTRENDER,this.context,e));}getRenderTransform(e,t,i,r,n,s,o){let a=r/t,l=-e[0]+o,h=-e[1];return(0,iu.compose)(this.tempTransform,n/2,s/2,a,-a,-i,l,h);}disposeInternal(){delete this.frameState,super.disposeInternal();}}function iV(e,t,i,r){return`${e},${(0,iF.getKeyZXY)(t,i,r)}`;}function ij(e,t,i){if(!(i in e))return e[i]=new Set([t]),!0;let r=e[i],n=r.has(t);return n||r.add(t),!n;}function iW(e,t){let i=e.layerStatesArray[e.layerIndex];i.extent&&(t=(0,el.getIntersection)(t,(0,ej.fromUserExtent)(i.extent,e.viewState.projection)));let r=i.layer.getRenderSource();if(!r.getWrapX()){let i=r.getTileGridForProjection(e.viewState.projection).getExtent();i&&(t=(0,el.getIntersection)(t,i));}return t;}class iX extends iU{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision_,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=(0,el.createEmpty)(),this.tempTileRange_=new iO.default(0,0,0,0),this.tempTileCoord_=(0,iF.createOrUpdate)(0,0,0);let i=void 0!==t.cacheSize?t.cacheSize:512;this.tileCache_=new ik(i),this.maxStaleKeys=.5*i;}getTileCache(){return this.tileCache_;}getOrCreateTile(e,t,i,r){let n;let s=this.tileCache_,o=this.getLayer().getSource(),a=iV(o.getKey(),e,t,i);if(s.containsKey(a))n=s.get(a);else{if(!(n=o.getTile(e,t,i,r.pixelRatio,r.viewState.projection)))return null;s.set(a,n);}return n;}getTile(e,t,i,r){return this.getOrCreateTile(e,t,i,r)||null;}getData(e){let t=this.frameState;if(!t)return null;let i=this.getLayer(),r=(0,iu.apply)(t.pixelToCoordinateTransform,e.slice()),n=i.getExtent();if(n&&!(0,el.containsCoordinate)(n,r))return null;let s=t.viewState,o=i.getRenderSource(),a=o.getTileGridForProjection(s.projection),l=o.getTilePixelRatio(t.pixelRatio);for(let e=a.getZForResolution(s.resolution);e>=a.getMinZoom();--e){let i;let n=a.getTileCoordForCoordAndZ(r,e),h=this.getTile(e,n[1],n[2],t);if(!h||h.getState()!==B.default.LOADED)continue;let d=a.getOrigin(e),u=(0,e8.toSize)(a.getTileSize(e)),c=a.getResolution(e);if(h instanceof iI.default||h instanceof iM.default)i=h.getImage();else if(!(h instanceof iA))continue;else if(!(i=iT(h.getData())))continue;let g=Math.floor(l*((r[0]-d[0])/c-n[1]*u[0])),p=Math.floor(l*((d[1]-r[1])/c-n[2]*u[1])),_=Math.round(l*o.getGutterForProjection(s.projection));return this.getImageData(i,g+_,p+_);}return null;}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;let t=this.getLayer().getSource();if(!t)return!1;let i=t.getRevision();return this.renderedRevision_?this.renderedRevision_!==i&&(this.renderedRevision_=i,this.renderedSourceKey_===t.getKey()&&this.tileCache_.clear()):this.renderedRevision_=i,!0;}enqueueTiles(e,t,i,r,n){let s=e.viewState,o=this.getLayer(),a=o.getRenderSource(),l=a.getTileGridForProjection(s.projection),h=(0,eF.getUid)(a);h in e.wantedTiles||(e.wantedTiles[h]={});let d=e.wantedTiles[h],u=o.getMapInternal(),c=Math.max(i-n,l.getMinZoom(),l.getZForResolution(Math.min(o.getMaxResolution(),u?u.getView().getResolutionForZoom(Math.max(o.getMinZoom(),0)):l.getResolution(0)),a.zDirection)),g=s.rotation,p=g?(0,el.getRotatedViewport)(s.center,s.resolution,g,e.size):void 0;for(let n=i;n>=c;--n){let i=l.getTileRangeForExtentAndZ(t,n,this.tempTileRange_),s=l.getResolution(n);for(let t=i.minX;t<=i.maxX;++t)for(let o=i.minY;o<=i.maxY;++o){if(g&&!l.tileCoordIntersectsViewport([n,t,o],p))continue;let i=this.getTile(n,t,o,e);if(!i||!ij(r,i,n))continue;let a=i.getKey();if(d[a]=!0,i.getState()===B.default.IDLE&&!e.tileQueue.isKeyQueued(a)){let r=(0,iF.createOrUpdate)(n,t,o,this.tempTileCoord_);e.tileQueue.enqueue([i,h,l.getTileCoordCenter(r),s]);}}}}findStaleTile_(e,t){let i=this.tileCache_,r=e[0],n=e[1],s=e[2],o=this.getStaleKeys();for(let e=0;e<o.length;++e){let a=iV(o[e],r,n,s);if(i.containsKey(a)){let e=i.peek(a);if(e.getState()===B.default.LOADED)return e.endTransition((0,eF.getUid)(this)),ij(t,e,r),!0;}}return!1;}findAltTiles_(e,t,i,r){let n=e.getTileRangeForTileCoordAndZ(t,i,this.tempTileRange_);if(!n)return!1;let s=!0,o=this.tileCache_,a=this.getLayer().getRenderSource().getKey();for(let e=n.minX;e<=n.maxX;++e)for(let t=n.minY;t<=n.maxY;++t){let n=iV(a,i,e,t),l=!1;if(o.containsKey(n)){let e=o.peek(n);e.getState()===B.default.LOADED&&(ij(r,e,i),l=!0);}l||(s=!1);}return s;}renderFrame(e,t){let i,r=!0;this.renderComplete=!0;let n=e.layerStatesArray[e.layerIndex],s=e.viewState,o=s.projection,a=s.resolution,l=s.center,h=e.pixelRatio,d=this.getLayer(),u=d.getSource(),c=u.getTileGridForProjection(o),g=c.getZForResolution(a,u.zDirection),p=c.getResolution(g),_=u.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==_&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=_):this.renderedSourceKey_=_;let f=e.extent,m=u.getTilePixelRatio(h);this.prepareContainer(e,t);let y=this.context.canvas.width,v=this.context.canvas.height,E=n.extent&&(0,ej.fromUserExtent)(n.extent,o);E&&(f=(0,el.getIntersection)(f,(0,ej.fromUserExtent)(n.extent,o)));let x=p*y/2/m,w=p*v/2/m,b=[l[0]-x,l[1]-w,l[0]+x,l[1]+w],C={};this.renderedTiles.length=0;let T=d.getPreload();if(e.nextExtent){let t=c.getZForResolution(s.nextResolution,u.zDirection),i=iW(e,e.nextExtent);this.enqueueTiles(e,i,t,C,T);}let L=iW(e,f);if(this.enqueueTiles(e,L,g,C,0),T>0&&setTimeout(()=>{this.enqueueTiles(e,L,g-1,C,T-1);},0),!(g in C))return this.container;let S=(0,eF.getUid)(this),A=e.time;for(let t of C[g]){let i=t.getState();if(i===B.default.EMPTY)continue;let n=t.tileCoord;if(i===B.default.LOADED&&1===t.getAlpha(S,A)){t.endTransition(S);continue;}if(i!==B.default.IDLE&&(r=!1),i!==B.default.ERROR&&(this.renderComplete=!1),this.findStaleTile_(n,C)){!function(e,t,i){let r=e[i];r&&r.delete(t);}(C,t,g),e.animate=!0;continue;}if(this.findAltTiles_(c,n,g+1,C))continue;let s=c.getMinZoom();for(let e=g-1;e>=s&&!this.findAltTiles_(c,n,e,C);--e);}let R=p/a*h/m,I=this.getRenderContext(e);(0,iu.compose)(this.tempTransform,y/2,v/2,R,R,0,-y/2,-v/2),n.extent&&this.clipUnrotated(I,e,E),u.getInterpolate()||(I.imageSmoothingEnabled=!1),this.preRender(I,e);let D=Object.keys(C).map(Number);D.sort($.ascending);let O=[],P=[];for(let t=D.length-1;t>=0;--t){let r=D[t],n=u.getTilePixelSize(r,h,o),s=c.getResolution(r)/p,a=n[0]*s*R,l=n[1]*s*R,d=c.getTileCoordForCoordAndZ((0,el.getTopLeft)(b),r),g=c.getTileCoordExtent(d),_=(0,iu.apply)(this.tempTransform,[m*(g[0]-b[0])/p,m*(b[3]-g[3])/p]),f=m*u.getGutterForProjection(o);for(let t of C[r]){if(t.getState()!==B.default.LOADED)continue;let n=t.tileCoord,s=d[1]-n[1],o=Math.round(_[0]-(s-1)*a),h=d[2]-n[2],c=Math.round(_[1]-(h-1)*l),g=Math.round(_[0]-s*a),p=Math.round(_[1]-h*l),m=o-g,y=c-p,v=1===D.length,E=!1;i=[g,p,g+m,p,g+m,p+y,g,p+y];for(let e=0,t=O.length;e<t;++e)if(!v&&r<P[e]){let t=O[e];(0,el.intersects)([g,p,g+m,p+y],[t[0],t[3],t[4],t[7]])&&(E||(I.save(),E=!0),I.beginPath(),I.moveTo(i[0],i[1]),I.lineTo(i[2],i[3]),I.lineTo(i[4],i[5]),I.lineTo(i[6],i[7]),I.moveTo(t[6],t[7]),I.lineTo(t[4],t[5]),I.lineTo(t[2],t[3]),I.lineTo(t[0],t[1]),I.clip());}O.push(i),P.push(r),this.drawTile(t,e,g,p,m,y,f,v),E&&I.restore(),this.renderedTiles.unshift(t),this.updateUsedTiles(e.usedTiles,u,t);}}return this.renderedResolution=p,this.extentChanged=!this.renderedExtent_||!(0,el.equals)(this.renderedExtent_,b),this.renderedExtent_=b,this.renderedPixelRatio=h,this.postRender(this.context,e),n.extent&&I.restore(),I.imageSmoothingEnabled=!0,this.renderComplete&&e.postRenderFunctions.push((e,t)=>{let i=(0,eF.getUid)(u),r=t.wantedTiles[i],n=r?Object.keys(r).length:0;this.updateCacheSize(n),this.tileCache_.expireCache();}),this.renderComplete||r||(e.animate=!0),this.container;}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,2*e);}drawTile(e,t,i,r,n,s,o,a){let l;if(e instanceof iA){if(!(l=iT(e.getData())))throw Error("Rendering array data is not yet supported");}else l=this.getTileImage(e);if(!l)return;let h=this.getRenderContext(t),d=(0,eF.getUid)(this),u=t.layerStatesArray[t.layerIndex],c=u.opacity*(a?e.getAlpha(d,t.time):1),g=c!==h.globalAlpha;g&&(h.save(),h.globalAlpha=c),h.drawImage(l,o,o,l.width-2*o,l.height-2*o,i,r,n,s),g&&h.restore(),c!==u.opacity?t.animate=!0:a&&e.endTransition(d);}getImage(){let e=this.context;return e?e.canvas:null;}getTileImage(e){return e.getImage();}updateUsedTiles(e,t,i){let r=(0,eF.getUid)(t);r in e||(e[r]={}),e[r][i.getKey()]=!0;}}var iH="preload",iq="useInterimTilesOnError";class iY extends eV.default{constructor(e){let t=Object.assign({},e=e||{}),i=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(void 0!==e.preload?e.preload:0),this.setUseInterimTilesOnError(void 0===e.useInterimTilesOnError||e.useInterimTilesOnError);}getCacheSize(){return this.cacheSize_;}getPreload(){return this.get(iH);}setPreload(e){this.set(iH,e);}getUseInterimTilesOnError(){return this.get(iq);}setUseInterimTilesOnError(e){this.set(iq,e);}getData(e){return super.getData(e);}}class i$ extends iY{constructor(e){super(e);}createRenderer(){return new iX(this,{cacheSize:this.getCacheSize()});}}var iZ=i("86a133d0");let iJ=/\{z\}/g,iQ=/\{x\}/g,i0=/\{y\}/g,i1=/\{-y\}/g;class i2 extends f.default{constructor(e){super(),this.projection=(0,ej.get)(e.projection),this.attributions_=i3(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=void 0!==e.state?e.state:"ready",this.wrapX_=void 0!==e.wrapX&&e.wrapX,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;let t=this;this.viewPromise_=new Promise(function(e,i){t.viewResolver=e,t.viewRejector=i;});}getAttributions(){return this.attributions_;}getAttributionsCollapsible(){return this.attributionsCollapsible_;}getProjection(){return this.projection;}getResolutions(e){return null;}getView(){return this.viewPromise_;}getState(){return this.state_;}getWrapX(){return this.wrapX_;}getInterpolate(){return this.interpolate_;}refresh(){this.changed();}setAttributions(e){this.attributions_=i3(e),this.changed();}setState(e){this.state_=e,this.changed();}}function i3(e){return e?"function"==typeof e?e:(Array.isArray(e)||(e=[e]),t=>e):null;}class i5 extends i2{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=void 0!==e.tilePixelRatio?e.tilePixelRatio:1,this.tileGrid=void 0!==e.tileGrid?e.tileGrid:null,this.tileGrid&&(0,e8.toSize)(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),[256,256]),this.tmpSize=[0,0],this.key_=e.key||(0,eF.getUid)(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0;}getGutterForProjection(e){return 0;}getKey(){return this.key_;}setKey(e){this.key_!==e&&(this.key_=e,this.changed());}getResolutions(e){let t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null;}getTile(e,t,i,r,n){return(0,eF.abstract)();}getTileGrid(){return this.tileGrid;}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:(0,iZ.getForProjection)(e);}getTilePixelRatio(e){return this.tilePixelRatio_;}getTilePixelSize(e,t,i){let r=this.getTileGridForProjection(i),n=this.getTilePixelRatio(t),s=(0,e8.toSize)(r.getTileSize(e),this.tmpSize);return 1==n?s:(0,e8.scale)(s,n,this.tmpSize);}getTileCoordForTileUrlFunction(e,t){let i=void 0!==t?t:this.getProjection(),r=void 0!==t?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=(0,iZ.wrapX)(r,e,i)),(0,iF.withinExtentAndZ)(e,r)?e:null;}clear(){}refresh(){this.clear(),super.refresh();}}class i6 extends y.default{constructor(e,t){super(e),this.tile=t;}}var i4={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class i8 extends i5{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===i8.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={};}getTileLoadFunction(){return this.tileLoadFunction;}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction;}getUrls(){return this.urls;}handleTileChange(e){let t;let i=e.target,r=(0,eF.getUid)(i),n=i.getState();n==B.default.LOADING?(this.tileLoadingKeys_[r]=!0,t=i4.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],t=n==B.default.ERROR?i4.TILELOADERROR:n==B.default.LOADED?i4.TILELOADEND:void 0),void 0!=t&&this.dispatchEvent(new i6(t,i));}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed();}setTileUrlFunction(e,t){this.tileUrlFunction=e,void 0!==t?this.setKey(t):this.changed();}setUrl(e){let t=function(e){let t=[],i=/\{([a-z])-([a-z])\}/.exec(e);if(i){let r;let n=i[1].charCodeAt(0),s=i[2].charCodeAt(0);for(r=n;r<=s;++r)t.push(e.replace(i[0],String.fromCharCode(r)));return t;}if(i=/\{(\d+)-(\d+)\}/.exec(e)){let r=parseInt(i[2],10);for(let n=parseInt(i[1],10);n<=r;n++)t.push(e.replace(i[0],n.toString()));return t;}return t.push(e),t;}(e);this.urls=t,this.setUrls(t);}setUrls(e){this.urls=e;let t=e.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(function(e,t){let i=e.length,r=Array(i);for(let n=0;n<i;++n)r[n]=function(e,t){return function(i,r,n){var s,o,a;let l;if(!i)return;let h=i[0];if(t){let e=t.getFullTileRange(h);e&&(l=e.getHeight()-1);}return s=i[1],o=i[2],a=l,e.replace(iJ,h.toString()).replace(iQ,s.toString()).replace(i0,o.toString()).replace(i1,function(){if(void 0===a)throw Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(a-o).toString();});};}(e[n],t);return 1===r.length?r[0]:function(e,t,i){if(!e)return;let n=(0,iF.hash)(e),s=(0,eO.modulo)(n,r.length);return r[s](e,t,i);};}(e,this.tileGrid),t):this.setKey(t);}tileUrlFunction(e,t,i){}}class i7 extends i8{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:i9,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:void 0===e.interpolate||e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null,this.tileClass=void 0!==e.tileClass?e.tileClass:iI.default,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1;}getGutterForProjection(e){return this.getProjection()&&e&&!(0,ej.equivalent)(this.getProjection(),e)?0:this.getGutter();}getGutter(){return 0;}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e;}getTileGridForProjection(e){let t=this.getProjection();if(this.tileGrid&&(!t||(0,ej.equivalent)(t,e)))return this.tileGrid;let i=(0,eF.getUid)(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=(0,iZ.getForProjection)(e)),this.tileGridForProjection[i];}createTile_(e,t,i,r,n,s){let o=[e,t,i],a=this.getTileCoordForTileUrlFunction(o,n),l=a?this.tileUrlFunction(a,r,n):void 0,h=new this.tileClass(o,void 0!==l?B.default.IDLE:B.default.EMPTY,void 0!==l?l:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=s,h.addEventListener(S.default.CHANGE,this.handleTileChange.bind(this)),h;}getTile(e,t,i,r,n){let s=this.getProjection();if(!s||!n||(0,ej.equivalent)(s,n))return this.getTileInternal(e,t,i,r,s||n);let o=[e,t,i],a=this.getKey(),l=this.getTileGridForProjection(s),h=this.getTileGridForProjection(n),d=this.getTileCoordForTileUrlFunction(o,n),u=new iM.default(s,l,n,h,o,d,this.getTilePixelRatio(r),this.getGutter(),(e,t,i,r)=>this.getTileInternal(e,t,i,r,s),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return u.key=a,u;}getTileInternal(e,t,i,r,n){let s=this.getKey();return this.createTile_(e,t,i,r,n,s);}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed());}setTileGridForProjection(e,t){let i=(0,ej.get)(e);if(i){let e=(0,eF.getUid)(i);e in this.tileGridForProjection||(this.tileGridForProjection[e]=t);}}}function i9(e,t){e.getImage().src=t;}class re extends i7{constructor(e){let t=void 0!==(e=e||{}).projection?e.projection:"EPSG:3857";super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:void 0!==e.tileGrid?e.tileGrid:(0,iZ.createXYZ)({extent:(0,iZ.extentFromProjection)(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize}),tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=void 0!==e.gutter?e.gutter:0;}getGutter(){return this.gutter_;}}let rt=e=>{let{mapId:t="map",center:i=[116.46,39.92],zoom:r=10,minZoom:n=0,maxZoom:o=18,style:l,children:h}=e;(0,a.useEffect)(()=>{let e=new H.default({center:i,zoom:r,minZoom:n,maxZoom:o,projection:"EPSG:4326"});new i_({target:t,layers:[new i$({source:new re({url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png"})})],view:e,controls:ea().extend([new iv])});},[]);let d=(0,a.useMemo)(()=>({position:"relative",width:"100vw",height:"100vh",...l}),[l]);return(0,s.jsx)("div",{id:t,style:d,children:h});};var ri={};i.e(ri,{Foo:function(){return g;},Map:function(){return rt;}});let rr={...ri},rn={name:"react-map-ol",description:"\u57FA\u4E8EOpenlayers\u7684React\u7EC4\u4EF6\u5C01\u88C5",version:"0.0.1",license:"MIT",repository:{type:"git",url:"https://github.com/zhaoyutaotao/react-map-ol.git"},authors:["zhaoyt"]},rs="browser",ro=void 0,ra={footer:!1,prefersColor:{default:"light",switch:!0},nprogress:!0,lastUpdated:!0,name:"react-map-ol",logo:"",siteUrl:{},showAntVProductsCard:!1,socialLinks:{github:"https://github.com/zhaoyutaotao/react-map-ol.git"},sourceLink:"https://github.com/zhaoyutaotao/react-map-ol/tree/main/{fileName}#L{line}",editLink:"https://github.com/zhaoyutaotao/react-map-ol/edit/main/{filename}"};function rl(){let e=(0,l.useOutlet)(),[t,i]=(0,a.useState)(!1),r=(0,a.useRef)(l.history.location.pathname);(0,a.useEffect)(()=>l.history.listen(e=>{e.location.pathname!==r.current&&(r.current=e.location.pathname,document.documentElement.scrollTo(0,0));}),[]);let n=a.default.useMemo(()=>{let e={pkg:rn,historyType:rs,entryExports:rr,demos:null,components:u,locales:c.locales,loading:t,setLoading:i,hostname:ro,themeConfig:ra,_2_level_nav_available:!0};return Object.defineProperty(e,"demos",{get:()=>((0,h.warning)(!1,"`demos` return empty in latest version, please use `useDemo` instead."),{})}),e;},[rn,rs,rr,u,c.locales,t,i,ro,ra,!0]);return(0,s.jsx)(d.SiteContext.Provider,{value:n,children:e});}}}]);
//# sourceMappingURL=c5ce9272-async.b59ed742.js.map